<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 R: Digits recognition on IDX images - DeepLearningWizard | One at a time</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 R: Digits recognition on IDX images - DeepLearningWizard | One at a time" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 R: Digits recognition on IDX images - DeepLearningWizard | One at a time" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Yihui Xie" />


<meta name="date" content="2019-09-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="working-with-data-frame.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">One at a time</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="part"><span><b>I Image Recognition</b></span></li>
<li class="chapter" data-level="1" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html"><i class="fa fa-check"></i><b>1</b> R: Digits recognition on IDX images - DeepLearningWizard</a><ul>
<li class="chapter" data-level="1.1" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#load-datasets"><i class="fa fa-check"></i><b>1.1</b> Load datasets</a><ul>
<li class="chapter" data-level="1.1.1" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#load-training-dataset"><i class="fa fa-check"></i><b>1.1.1</b> Load training dataset</a></li>
<li class="chapter" data-level="1.1.2" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#introspection"><i class="fa fa-check"></i><b>1.1.2</b> Introspection</a></li>
<li class="chapter" data-level="1.1.3" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#class-and-length-of-train_dataset"><i class="fa fa-check"></i><b>1.1.3</b> Class and length of <code>train_dataset</code></a></li>
<li class="chapter" data-level="1.1.4" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#introspection-training-dataset"><i class="fa fa-check"></i><b>1.1.4</b> Introspection training dataset</a></li>
<li class="chapter" data-level="1.1.5" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#mnist-image-from-training-dataset"><i class="fa fa-check"></i><b>1.1.5</b> MNIST image from training dataset</a></li>
<li class="chapter" data-level="1.1.6" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#plot-a-second-image"><i class="fa fa-check"></i><b>1.1.6</b> Plot a second image</a></li>
<li class="chapter" data-level="1.1.7" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#loading-the-test-dataset"><i class="fa fa-check"></i><b>1.1.7</b> Loading the test dataset</a></li>
<li class="chapter" data-level="1.1.8" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#plot-image-test-dataset"><i class="fa fa-check"></i><b>1.1.8</b> Plot image test dataset</a></li>
<li class="chapter" data-level="1.1.9" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#plot-a-second-test-image"><i class="fa fa-check"></i><b>1.1.9</b> Plot a second test image</a></li>
<li class="chapter" data-level="1.1.10" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#plot-the-last-test-image"><i class="fa fa-check"></i><b>1.1.10</b> Plot the last test image</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#defining-epochs"><i class="fa fa-check"></i><b>1.2</b> Defining epochs</a></li>
<li class="chapter" data-level="1.3" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#create-iterable-objects-training-and-testing-dataset"><i class="fa fa-check"></i><b>1.3</b> Create iterable objects: training and testing dataset</a><ul>
<li class="chapter" data-level="1.3.1" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#check-iteraibility"><i class="fa fa-check"></i><b>1.3.1</b> Check iteraibility</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#building-the-model"><i class="fa fa-check"></i><b>1.4</b> Building the model</a><ul>
<li class="chapter" data-level="1.4.1" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#instantiate-model-class-based-on-input-and-out-dimensions"><i class="fa fa-check"></i><b>1.4.1</b> Instantiate model class based on input and out dimensions</a></li>
<li class="chapter" data-level="1.4.2" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#instantiate-cross-entropy-loss-class"><i class="fa fa-check"></i><b>1.4.2</b> Instantiate Cross Entropy Loss class</a></li>
<li class="chapter" data-level="1.4.3" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#instantiate-optimizer-class"><i class="fa fa-check"></i><b>1.4.3</b> Instantiate Optimizer class</a></li>
<li class="chapter" data-level="1.4.4" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#parameters-introspection"><i class="fa fa-check"></i><b>1.4.4</b> Parameters introspection</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#train-the-model-and-test-per-epoch"><i class="fa fa-check"></i><b>1.5</b> Train the model and test per epoch</a></li>
<li class="chapter" data-level="1.6" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#break-down-accuracy-calculation"><i class="fa fa-check"></i><b>1.6</b> Break down accuracy calculation</a><ul>
<li class="chapter" data-level="1.6.1" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#printing-output-size"><i class="fa fa-check"></i><b>1.6.1</b> Printing output size</a></li>
<li class="chapter" data-level="1.6.2" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#printing-one-output"><i class="fa fa-check"></i><b>1.6.2</b> Printing one output</a></li>
<li class="chapter" data-level="1.6.3" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#printing-prediction-output"><i class="fa fa-check"></i><b>1.6.3</b> Printing prediction output</a></li>
<li class="chapter" data-level="1.6.4" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#print-prediction-value"><i class="fa fa-check"></i><b>1.6.4</b> Print prediction value</a></li>
<li class="chapter" data-level="1.6.5" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#print-prediction-label-and-label-size"><i class="fa fa-check"></i><b>1.6.5</b> Print prediction, label and label size</a></li>
<li class="chapter" data-level="1.6.6" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#print-second-prediction-and-ground-truth"><i class="fa fa-check"></i><b>1.6.6</b> Print second prediction and ground truth</a></li>
<li class="chapter" data-level="1.6.7" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#print-accuracy"><i class="fa fa-check"></i><b>1.6.7</b> Print accuracy</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="r-digits-recognition-on-idx-images-deeplearningwizard.html"><a href="r-digits-recognition-on-idx-images-deeplearningwizard.html#saving-pytorch-model"><i class="fa fa-check"></i><b>1.7</b> Saving PyTorch model</a></li>
</ul></li>
<li class="part"><span><b>II PyTorch and R data structures</b></span></li>
<li class="chapter" data-level="2" data-path="working-with-data-frame.html"><a href="working-with-data-frame.html"><i class="fa fa-check"></i><b>2</b> Working with data.frame</a><ul>
<li class="chapter" data-level="2.1" data-path="working-with-data-frame.html"><a href="working-with-data-frame.html#load-pytorch-libraries"><i class="fa fa-check"></i><b>2.1</b> Load PyTorch libraries</a></li>
<li class="chapter" data-level="2.2" data-path="working-with-data-frame.html"><a href="working-with-data-frame.html#dataset-iteration-batch-settings"><i class="fa fa-check"></i><b>2.2</b> Dataset iteration batch settings</a></li>
<li class="chapter" data-level="2.3" data-path="working-with-data-frame.html"><a href="working-with-data-frame.html#summary-statistics-for-tensors"><i class="fa fa-check"></i><b>2.3</b> Summary statistics for tensors</a></li>
<li class="chapter" data-level="2.4" data-path="working-with-data-frame.html"><a href="working-with-data-frame.html#using-data.frame"><i class="fa fa-check"></i><b>2.4</b> using <code>data.frame</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="working-with-data-table.html"><a href="working-with-data-table.html"><i class="fa fa-check"></i><b>3</b> Working with data.table</a><ul>
<li class="chapter" data-level="3.1" data-path="working-with-data-table.html"><a href="working-with-data-table.html#load-pytorch-libraries-1"><i class="fa fa-check"></i><b>3.1</b> Load PyTorch libraries</a><ul>
<li class="chapter" data-level="3.1.1" data-path="working-with-data-table.html"><a href="working-with-data-table.html#using-data.table"><i class="fa fa-check"></i><b>3.1.1</b> Using `data.table</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III PyTorch with Rmarkdown</b></span></li>
<li class="chapter" data-level="4" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html"><i class="fa fa-check"></i><b>4</b> Simple Regression with PyTorch</a><ul>
<li class="chapter" data-level="4.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#creating-the-network-model"><i class="fa fa-check"></i><b>4.1</b> Creating the network model</a><ul>
<li class="chapter" data-level="4.1.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-r"><i class="fa fa-check"></i><b>4.1.1</b> Code in R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#datasets"><i class="fa fa-check"></i><b>4.2</b> Datasets</a><ul>
<li class="chapter" data-level="4.2.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-r-1"><i class="fa fa-check"></i><b>4.2.1</b> Code in R</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#optimizer-and-loss"><i class="fa fa-check"></i><b>4.3</b> Optimizer and Loss</a><ul>
<li class="chapter" data-level="4.3.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#equivalent-code-in-r"><i class="fa fa-check"></i><b>4.3.1</b> Equivalent code in R</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#training"><i class="fa fa-check"></i><b>4.4</b> Training</a><ul>
<li class="chapter" data-level="4.4.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-python"><i class="fa fa-check"></i><b>4.4.1</b> Code in Python</a></li>
<li class="chapter" data-level="4.4.2" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-r-2"><i class="fa fa-check"></i><b>4.4.2</b> Code in R</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#result"><i class="fa fa-check"></i><b>4.5</b> Result</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="autograd.html"><a href="autograd.html"><i class="fa fa-check"></i><b>5</b> Autograd</a><ul>
<li class="chapter" data-level="5.1" data-path="autograd.html"><a href="autograd.html#python-code"><i class="fa fa-check"></i><b>5.1</b> Python code</a></li>
<li class="chapter" data-level="5.2" data-path="autograd.html"><a href="autograd.html#r-code"><i class="fa fa-check"></i><b>5.2</b> R code</a></li>
<li class="chapter" data-level="5.3" data-path="autograd.html"><a href="autograd.html#observations"><i class="fa fa-check"></i><b>5.3</b> Observations</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">One at a time</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-digits-recognition-on-idx-images---deeplearningwizard" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> R: Digits recognition on IDX images - DeepLearningWizard</h1>
<p>Source: <a href="https://www.deeplearningwizard.com/deep_learning/practical_pytorch/pytorch_logistic_regression/" class="uri">https://www.deeplearningwizard.com/deep_learning/practical_pytorch/pytorch_logistic_regression/</a></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(rTorch)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">torch       &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;torch&quot;</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">torchvision &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;torchvision&quot;</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">nn          &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;torch.nn&quot;</span>)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">transforms  &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;torchvision.transforms&quot;</span>)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">dsets       &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;torchvision.datasets&quot;</span>)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">builtins    &lt;-<span class="st"> </span><span class="kw">import_builtins</span>()</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">np          &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;numpy&quot;</span>)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"></a>
<a class="sourceLine" id="cb2-11" data-line-number="11">batch_size_train &lt;-<span class="st">  </span>64L</a></code></pre></div>
<div id="load-datasets" class="section level2">
<h2><span class="header-section-number">1.1</span> Load datasets</h2>
<div id="load-training-dataset" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Load training dataset</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">train_dataset =<span class="st"> </span>dsets<span class="op">$</span><span class="kw">MNIST</span>(<span class="dt">root=</span><span class="kw">file.path</span>(<span class="st">&quot;.&quot;</span>, <span class="st">&#39;data&#39;</span>), </a>
<a class="sourceLine" id="cb3-2" data-line-number="2">                            <span class="dt">train=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                            <span class="dt">transform=</span>transforms<span class="op">$</span><span class="kw">ToTensor</span>(),</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">                            <span class="dt">download=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">                            </a>
<a class="sourceLine" id="cb3-6" data-line-number="6">train_dataset</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; Dataset MNIST</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt;     Number of datapoints: 60000</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt;     Root location: ./data</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;     Split: Train</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">builtins<span class="op">$</span><span class="kw">len</span>(train_dataset)</a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; [1] 60000</span></a></code></pre></div>
</div>
<div id="introspection" class="section level3">
<h3><span class="header-section-number">1.1.2</span> Introspection</h3>
</div>
<div id="class-and-length-of-train_dataset" class="section level3">
<h3><span class="header-section-number">1.1.3</span> Class and length of <code>train_dataset</code></h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># R</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">class</span>(train_dataset)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; [1] &quot;torchvision.datasets.mnist.MNIST&quot;         </span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; [2] &quot;torchvision.datasets.vision.VisionDataset&quot;</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; [3] &quot;torch.utils.data.dataset.Dataset&quot;         </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; [4] &quot;python.builtin.object&quot;</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="kw">length</span>(train_dataset)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Python</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">builtins<span class="op">$</span><span class="kw">type</span>(train_dataset)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; &lt;class &#39;torchvision.datasets.mnist.MNIST&#39;&gt;</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">builtins<span class="op">$</span><span class="kw">len</span>(train_dataset)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; [1] 60000</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="kw">py_len</span>(train_dataset)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; [1] 60000</span></a></code></pre></div>
<blockquote>
<p>Note that both similar commands produce different results</p>
</blockquote>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">names</span>(train_dataset)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt;  [1] &quot;class_to_idx&quot;     &quot;classes&quot;          &quot;data&quot;            </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt;  [4] &quot;download&quot;         &quot;extra_repr&quot;       &quot;extract_gzip&quot;    </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt;  [7] &quot;processed_folder&quot; &quot;raw_folder&quot;       &quot;root&quot;            </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; [10] &quot;target_transform&quot; &quot;targets&quot;          &quot;test_data&quot;       </span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; [13] &quot;test_file&quot;        &quot;test_labels&quot;      &quot;train&quot;           </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; [16] &quot;train_data&quot;       &quot;train_labels&quot;     &quot;training_file&quot;   </span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; [19] &quot;transform&quot;        &quot;transforms&quot;       &quot;urls&quot;</span></a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">reticulate<span class="op">::</span><span class="kw">py_list_attributes</span>(train_dataset)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt;  [1] &quot;__add__&quot;                &quot;__class__&quot;             </span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt;  [3] &quot;__delattr__&quot;            &quot;__dict__&quot;              </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;  [5] &quot;__dir__&quot;                &quot;__doc__&quot;               </span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt;  [7] &quot;__eq__&quot;                 &quot;__format__&quot;            </span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;  [9] &quot;__ge__&quot;                 &quot;__getattribute__&quot;      </span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; [11] &quot;__getitem__&quot;            &quot;__gt__&quot;                </span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; [13] &quot;__hash__&quot;               &quot;__init__&quot;              </span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; [15] &quot;__init_subclass__&quot;      &quot;__le__&quot;                </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; [17] &quot;__len__&quot;                &quot;__lt__&quot;                </span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; [19] &quot;__module__&quot;             &quot;__ne__&quot;                </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; [21] &quot;__new__&quot;                &quot;__reduce__&quot;            </span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; [23] &quot;__reduce_ex__&quot;          &quot;__repr__&quot;              </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; [25] &quot;__setattr__&quot;            &quot;__sizeof__&quot;            </span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; [27] &quot;__str__&quot;                &quot;__subclasshook__&quot;      </span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; [29] &quot;__weakref__&quot;            &quot;_check_exists&quot;         </span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; [31] &quot;_format_transform_repr&quot; &quot;_repr_indent&quot;          </span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt; [33] &quot;class_to_idx&quot;           &quot;classes&quot;               </span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co">#&gt; [35] &quot;data&quot;                   &quot;download&quot;              </span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt; [37] &quot;extra_repr&quot;             &quot;extract_gzip&quot;          </span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt; [39] &quot;processed_folder&quot;       &quot;raw_folder&quot;            </span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt; [41] &quot;root&quot;                   &quot;target_transform&quot;      </span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; [43] &quot;targets&quot;                &quot;test_data&quot;             </span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt; [45] &quot;test_file&quot;              &quot;test_labels&quot;           </span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">#&gt; [47] &quot;train&quot;                  &quot;train_data&quot;            </span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">#&gt; [49] &quot;train_labels&quot;           &quot;training_file&quot;         </span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#&gt; [51] &quot;transform&quot;              &quot;transforms&quot;            </span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt; [53] &quot;urls&quot;</span></a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># this is identical to Python len() function</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">train_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__len__</span><span class="st">`</span>()</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; [1] 60000</span></a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># this is not what we are looking for which is torch.Size([1, 28, 28])</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co"># d0 &lt;- train_dataset$data[0][0]</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">d0 &lt;-<span class="st"> </span>train_dataset<span class="op">$</span>data[<span class="dv">1</span>][<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; Warning in `[.torch.Tensor`(train_dataset$data, 1): Incorrect number of</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; dimensions supplied. The number of supplied arguments, (not counting any</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; NULL, tf$newaxis or np$newaxis) must match thenumber of dimensions in the</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; tensor, unless an all_dims() was supplied (this will produce an error in</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; the future)</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt; Warning in `[.torch.Tensor`(train_dataset$data[1], 1): Incorrect number of</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; dimensions supplied. The number of supplied arguments, (not counting any</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; NULL, tf$newaxis or np$newaxis) must match thenumber of dimensions in the</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt; tensor, unless an all_dims() was supplied (this will produce an error in</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt; the future)</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="kw">class</span>(d0)</a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; [1] &quot;torch.Tensor&quot;          &quot;torch._C._TensorBase&quot;  &quot;python.builtin.object&quot;</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16">d0<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; torch.Size([28])</span></a></code></pre></div>
<pre><code>d0 &lt;- train_dataset$data[0][0]
Error: It looks like you might be using 0-based indexing to extract using `[`. The rTorch package now uses 1-based extraction by default. You can switch to the old behavior (0-based extraction) with: options(torch.extract.one_based = FALSE)</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># this is identical to train_dataset.data.size() in Python</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">train_dataset<span class="op">$</span>data<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; torch.Size([60000, 28, 28])</span></a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># this is not a dimension we are looking for either</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">train_dataset<span class="op">$</span>data[<span class="kw">c</span>(1L)][1L]<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt; Warning in `[.torch.Tensor`(train_dataset$data, c(1L)): Incorrect number</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt; of dimensions supplied. The number of supplied arguments, (not counting any</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; NULL, tf$newaxis or np$newaxis) must match thenumber of dimensions in the</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; tensor, unless an all_dims() was supplied (this will produce an error in</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; the future)</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt; Warning in `[.torch.Tensor`(train_dataset$data[c(1L)], 1L): Incorrect</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; number of dimensions supplied. The number of supplied arguments, (not</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; counting any NULL, tf$newaxis or np$newaxis) must match thenumber of</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; dimensions in the tensor, unless an all_dims() was supplied (this will</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; produce an error in the future)</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; torch.Size([28])</span></a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># py = import_builtins()</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">enum_train_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(train_dataset)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw">class</span>(enum_train_dataset)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; [1] &quot;python.builtin.iterator&quot;  &quot;python.builtin.enumerate&quot;</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; [3] &quot;python.builtin.object&quot;</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co"># enum_train_dataset$`__count__`</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">reticulate<span class="op">::</span><span class="kw">py_list_attributes</span>(enum_train_dataset)</a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt;  [1] &quot;__class__&quot;         &quot;__delattr__&quot;       &quot;__dir__&quot;          </span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt;  [4] &quot;__doc__&quot;           &quot;__eq__&quot;            &quot;__format__&quot;       </span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt;  [7] &quot;__ge__&quot;            &quot;__getattribute__&quot;  &quot;__gt__&quot;           </span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt; [10] &quot;__hash__&quot;          &quot;__init__&quot;          &quot;__init_subclass__&quot;</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt; [13] &quot;__iter__&quot;          &quot;__le__&quot;            &quot;__lt__&quot;           </span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt; [16] &quot;__ne__&quot;            &quot;__new__&quot;           &quot;__next__&quot;         </span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt; [19] &quot;__reduce__&quot;        &quot;__reduce_ex__&quot;     &quot;__repr__&quot;         </span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#&gt; [22] &quot;__setattr__&quot;       &quot;__sizeof__&quot;        &quot;__str__&quot;          </span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#&gt; [25] &quot;__subclasshook__&quot;</span></a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># this is not a number we were expecting</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">enum_train_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__sizeof__</span><span class="st">`</span>()</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt; [1] 48</span></a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">train_dataset<span class="op">$</span>data<span class="op">$</span><span class="kw">nelement</span>()  <span class="co"># total number of elements in the tensor</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co">#&gt; [1] 47040000</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3">train_dataset<span class="op">$</span>data<span class="op">$</span>shape       <span class="co"># shape</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#&gt; torch.Size([60000, 28, 28])</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5">train_dataset<span class="op">$</span>data<span class="op">$</span><span class="kw">size</span>()      <span class="co"># size</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt; torch.Size([60000, 28, 28])</span></a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># get index, label and image</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co"># the pointer will move forward everytime we run the chunk</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3">obj   &lt;-<span class="st"> </span>reticulate<span class="op">::</span><span class="kw">iter_next</span>(enum_train_dataset)</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">idx   &lt;-<span class="st"> </span>obj[[<span class="dv">1</span>]]        <span class="co"># index number</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">image &lt;-<span class="st"> </span>obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">label &lt;-<span class="st"> </span>obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb16-8" data-line-number="8"></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="kw">cat</span>(idx, label, <span class="kw">class</span>(label), <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">#&gt; 0 5 integer  </span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="kw">print</span>(image<span class="op">$</span><span class="kw">size</span>())</a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="co">#&gt; torch.Size([1, 28, 28])</span></a></code></pre></div>
</div>
<div id="introspection-training-dataset" class="section level3">
<h3><span class="header-section-number">1.1.4</span> Introspection training dataset</h3>
<div id="inspecting-a-single-image" class="section level4">
<h4><span class="header-section-number">1.1.4.1</span> Inspecting a single image</h4>
<p>So this is how a single image is represented in numbers. Itâ€™s actually a 28 pixel x 28 pixel image which is why you would end up with this 28x28 matrix of numbers.</p>
</div>
<div id="inspecting-training-dataset-first-element-of-tuple" class="section level4">
<h4><span class="header-section-number">1.1.4.2</span> Inspecting training dataset first element of tuple</h4>
<p>This means to access the image, you need to access the first element in the tuple.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># Input Matrix</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">image<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co">#&gt; torch.Size([1, 28, 28])</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co"># A 28x28 sized image of a digit</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co"># torch.Size([1, 28, 28])</span></a></code></pre></div>
</div>
</div>
<div id="mnist-image-from-training-dataset" class="section level3">
<h3><span class="header-section-number">1.1.5</span> MNIST image from training dataset</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">class</span>(image<span class="op">$</span><span class="kw">numpy</span>())</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt; [1] &quot;array&quot;</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="kw">dim</span>(image<span class="op">$</span><span class="kw">numpy</span>())</a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co">#&gt; [1]  1 28 28</span></a></code></pre></div>
<div id="plot-one-image" class="section level4">
<h4><span class="header-section-number">1.1.5.1</span> Plot one image</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">rotate &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">t</span>(<span class="kw">apply</span>(x, <span class="dv">2</span>, rev))   <span class="co">#function to rotate the matrix</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co"># read label for digit</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4">label</a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">#&gt; [1] 5</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co"># read tensor for image</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co"># img_tensor_2d &lt;- image[0]</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9">img_tensor_2d &lt;-<span class="st"> </span>image[1L]</a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="co">#&gt; Warning in `[.torch.Tensor`(image, 1L): Incorrect number of dimensions</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="co">#&gt; supplied. The number of supplied arguments, (not counting any NULL,</span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="co">#&gt; tf$newaxis or np$newaxis) must match thenumber of dimensions in the tensor,</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="co">#&gt; unless an all_dims() was supplied (this will produce an error in the</span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="co">#&gt; future)</span></a>
<a class="sourceLine" id="cb19-15" data-line-number="15">img_tensor_2d<span class="op">$</span>shape       <span class="co"># shape of the 2D tensor: torch.Size([28, 28])</span></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"><span class="co">#&gt; torch.Size([28, 28])</span></a>
<a class="sourceLine" id="cb19-17" data-line-number="17"></a>
<a class="sourceLine" id="cb19-18" data-line-number="18"><span class="co"># convert tensor to numpy array</span></a>
<a class="sourceLine" id="cb19-19" data-line-number="19">img_mat_2d &lt;-<span class="st"> </span>img_tensor_2d<span class="op">$</span><span class="kw">numpy</span>()</a>
<a class="sourceLine" id="cb19-20" data-line-number="20"><span class="kw">dim</span>(img_mat_2d)</a>
<a class="sourceLine" id="cb19-21" data-line-number="21"><span class="co">#&gt; [1] 28 28</span></a>
<a class="sourceLine" id="cb19-22" data-line-number="22"></a>
<a class="sourceLine" id="cb19-23" data-line-number="23"><span class="co"># show digit image</span></a>
<a class="sourceLine" id="cb19-24" data-line-number="24"><span class="kw">image</span>(<span class="kw">rotate</span>(img_mat_2d))</a>
<a class="sourceLine" id="cb19-25" data-line-number="25"><span class="kw">title</span>(label)</a></code></pre></div>
<p><img src="0611-mnist_idx_download_files/figure-html/unnamed-chunk-18-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="plot-a-second-image" class="section level3">
<h3><span class="header-section-number">1.1.6</span> Plot a second image</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co"># iterate to the next tensor</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">obj &lt;-<span class="st"> </span>reticulate<span class="op">::</span><span class="kw">iter_next</span>(enum_train_dataset)   <span class="co"># iterator</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3">idx &lt;-<span class="st"> </span>obj[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">img &lt;-<span class="st"> </span>obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">lbl &lt;-<span class="st"> </span>obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb20-6" data-line-number="6"></a>
<a class="sourceLine" id="cb20-7" data-line-number="7">img_tensor_2d &lt;-<span class="st"> </span>img[<span class="dv">1</span>]            <span class="co"># get 2D tensor</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#&gt; Warning in `[.torch.Tensor`(img, 1): Incorrect number of dimensions</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt; supplied. The number of supplied arguments, (not counting any NULL,</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt; tf$newaxis or np$newaxis) must match thenumber of dimensions in the tensor,</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt; unless an all_dims() was supplied (this will produce an error in the</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">#&gt; future)</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13">img_mat_2d &lt;-<span class="st"> </span>img_tensor_2d<span class="op">$</span><span class="kw">numpy</span>()  <span class="co"># convert to 2D array</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co"># show digit image</span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="kw">image</span>(<span class="kw">rotate</span>(img_mat_2d))            <span class="co"># rotate and plot</span></a>
<a class="sourceLine" id="cb20-17" data-line-number="17"><span class="kw">title</span>(lbl)                         <span class="co"># label as plot title</span></a></code></pre></div>
<p><img src="0611-mnist_idx_download_files/figure-html/unnamed-chunk-19-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="loading-the-test-dataset" class="section level3">
<h3><span class="header-section-number">1.1.7</span> Loading the test dataset</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">test_dataset =<span class="st"> </span>dsets<span class="op">$</span><span class="kw">MNIST</span>(<span class="dt">root =</span> <span class="st">&#39;../../data&#39;</span>, </a>
<a class="sourceLine" id="cb21-2" data-line-number="2">                           <span class="dt">train=</span><span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb21-3" data-line-number="3">                           <span class="dt">transform=</span>transforms<span class="op">$</span><span class="kw">ToTensor</span>())</a>
<a class="sourceLine" id="cb21-4" data-line-number="4"></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="kw">py_len</span>(test_dataset)</a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#&gt; [1] 10000</span></a></code></pre></div>
<div id="introspection-of-the-test-dataset" class="section level4">
<h4><span class="header-section-number">1.1.7.1</span> Introspection of the test dataset</h4>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># we&#39;ll get all the attributes of the class</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">reticulate<span class="op">::</span><span class="kw">py_list_attributes</span>(test_dataset)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">#&gt;  [1] &quot;__add__&quot;                &quot;__class__&quot;             </span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="co">#&gt;  [3] &quot;__delattr__&quot;            &quot;__dict__&quot;              </span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co">#&gt;  [5] &quot;__dir__&quot;                &quot;__doc__&quot;               </span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="co">#&gt;  [7] &quot;__eq__&quot;                 &quot;__format__&quot;            </span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="co">#&gt;  [9] &quot;__ge__&quot;                 &quot;__getattribute__&quot;      </span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co">#&gt; [11] &quot;__getitem__&quot;            &quot;__gt__&quot;                </span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="co">#&gt; [13] &quot;__hash__&quot;               &quot;__init__&quot;              </span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="co">#&gt; [15] &quot;__init_subclass__&quot;      &quot;__le__&quot;                </span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="co">#&gt; [17] &quot;__len__&quot;                &quot;__lt__&quot;                </span></a>
<a class="sourceLine" id="cb22-12" data-line-number="12"><span class="co">#&gt; [19] &quot;__module__&quot;             &quot;__ne__&quot;                </span></a>
<a class="sourceLine" id="cb22-13" data-line-number="13"><span class="co">#&gt; [21] &quot;__new__&quot;                &quot;__reduce__&quot;            </span></a>
<a class="sourceLine" id="cb22-14" data-line-number="14"><span class="co">#&gt; [23] &quot;__reduce_ex__&quot;          &quot;__repr__&quot;              </span></a>
<a class="sourceLine" id="cb22-15" data-line-number="15"><span class="co">#&gt; [25] &quot;__setattr__&quot;            &quot;__sizeof__&quot;            </span></a>
<a class="sourceLine" id="cb22-16" data-line-number="16"><span class="co">#&gt; [27] &quot;__str__&quot;                &quot;__subclasshook__&quot;      </span></a>
<a class="sourceLine" id="cb22-17" data-line-number="17"><span class="co">#&gt; [29] &quot;__weakref__&quot;            &quot;_check_exists&quot;         </span></a>
<a class="sourceLine" id="cb22-18" data-line-number="18"><span class="co">#&gt; [31] &quot;_format_transform_repr&quot; &quot;_repr_indent&quot;          </span></a>
<a class="sourceLine" id="cb22-19" data-line-number="19"><span class="co">#&gt; [33] &quot;class_to_idx&quot;           &quot;classes&quot;               </span></a>
<a class="sourceLine" id="cb22-20" data-line-number="20"><span class="co">#&gt; [35] &quot;data&quot;                   &quot;download&quot;              </span></a>
<a class="sourceLine" id="cb22-21" data-line-number="21"><span class="co">#&gt; [37] &quot;extra_repr&quot;             &quot;extract_gzip&quot;          </span></a>
<a class="sourceLine" id="cb22-22" data-line-number="22"><span class="co">#&gt; [39] &quot;processed_folder&quot;       &quot;raw_folder&quot;            </span></a>
<a class="sourceLine" id="cb22-23" data-line-number="23"><span class="co">#&gt; [41] &quot;root&quot;                   &quot;target_transform&quot;      </span></a>
<a class="sourceLine" id="cb22-24" data-line-number="24"><span class="co">#&gt; [43] &quot;targets&quot;                &quot;test_data&quot;             </span></a>
<a class="sourceLine" id="cb22-25" data-line-number="25"><span class="co">#&gt; [45] &quot;test_file&quot;              &quot;test_labels&quot;           </span></a>
<a class="sourceLine" id="cb22-26" data-line-number="26"><span class="co">#&gt; [47] &quot;train&quot;                  &quot;train_data&quot;            </span></a>
<a class="sourceLine" id="cb22-27" data-line-number="27"><span class="co">#&gt; [49] &quot;train_labels&quot;           &quot;training_file&quot;         </span></a>
<a class="sourceLine" id="cb22-28" data-line-number="28"><span class="co">#&gt; [51] &quot;transform&quot;              &quot;transforms&quot;            </span></a>
<a class="sourceLine" id="cb22-29" data-line-number="29"><span class="co">#&gt; [53] &quot;urls&quot;</span></a></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># get the Python type</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2">builtins<span class="op">$</span><span class="kw">type</span>(test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(0L))   <span class="co"># in Python a tuple gets converted to a list</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">#&gt; &lt;class &#39;list&#39;&gt;</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co"># in Python: type(test_dataset[0]) -&gt; &lt;class &#39;tuple&#39;&gt;</span></a></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co"># the size of the first and last image tensor</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(0L)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">size</span>()      <span class="co"># same as test_dataset[0][0].size()</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">#&gt; torch.Size([1, 28, 28])</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4">test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(9999L)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">size</span>()  </a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">#&gt; torch.Size([1, 28, 28])</span></a></code></pre></div>
<p>This is the same as:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">py_to_r</span>(test_dataset)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="co">#&gt; Dataset MNIST</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="co">#&gt;     Number of datapoints: 10000</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="co">#&gt;     Root location: ../../data</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="co">#&gt;     Split: Test</span></a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># the size of the first and last image tensor</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="co"># py_get_item(test_dataset, 0L)[[1]]$size()</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="kw">py_get_item</span>(test_dataset, 0L)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="co">#&gt; torch.Size([1, 28, 28])</span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="kw">py_get_item</span>(test_dataset, 9999L)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb26-6" data-line-number="6"><span class="co">#&gt; torch.Size([1, 28, 28])</span></a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="co"># same as test_dataset[0][0].size()</span></a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co"># the label is the second list member</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">label &lt;-<span class="st"> </span>test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(0L)[[<span class="dv">2</span>]]  <span class="co"># in Python: test_dataset[0][1]</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3">label</a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="co">#&gt; [1] 7</span></a></code></pre></div>
</div>
</div>
<div id="plot-image-test-dataset" class="section level3">
<h3><span class="header-section-number">1.1.8</span> Plot image test dataset</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># convert tensor to numpy array</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2">.show_img &lt;-<span class="st"> </span>test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(0L)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">numpy</span>() </a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="kw">dim</span>(.show_img)                                           <span class="co"># numpy 3D array</span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="co">#&gt; [1]  1 28 28</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5"></a>
<a class="sourceLine" id="cb28-6" data-line-number="6"><span class="co"># reshape 3D array to 2D </span></a>
<a class="sourceLine" id="cb28-7" data-line-number="7">show_img &lt;-<span class="st"> </span>np<span class="op">$</span><span class="kw">reshape</span>(.show_img, <span class="kw">c</span>(28L, 28L))</a>
<a class="sourceLine" id="cb28-8" data-line-number="8"><span class="kw">dim</span>(show_img)</a>
<a class="sourceLine" id="cb28-9" data-line-number="9"><span class="co">#&gt; [1] 28 28</span></a></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co"># another way to reshape the array</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2">show_img &lt;-<span class="st"> </span>np<span class="op">$</span><span class="kw">reshape</span>(test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(0L)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">numpy</span>(), <span class="kw">c</span>(28L, 28L))</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="kw">dim</span>(show_img)</a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="co">#&gt; [1] 28 28</span></a></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co"># show in grays and rotate</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw">image</span>(<span class="kw">rotate</span>(show_img), <span class="dt">col =</span> <span class="kw">gray.colors</span>(<span class="dv">64</span>))</a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="kw">title</span>(label)</a></code></pre></div>
<p><img src="0611-mnist_idx_download_files/figure-html/unnamed-chunk-29-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-a-second-test-image" class="section level3">
<h3><span class="header-section-number">1.1.9</span> Plot a second test image</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="co"># next image, index moves from (0L) to (1L), and so on</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2">idx &lt;-<span class="st"> </span>1L</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">.show_img &lt;-<span class="st"> </span>test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(idx)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">numpy</span>()</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">show_img  &lt;-<span class="st"> </span>np<span class="op">$</span><span class="kw">reshape</span>(.show_img, <span class="kw">c</span>(28L, 28L))</a>
<a class="sourceLine" id="cb31-5" data-line-number="5">label     &lt;-<span class="st"> </span>test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(idx)[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb31-6" data-line-number="6"></a>
<a class="sourceLine" id="cb31-7" data-line-number="7"><span class="kw">image</span>(<span class="kw">rotate</span>(show_img), <span class="dt">col =</span> <span class="kw">gray.colors</span>(<span class="dv">64</span>))</a>
<a class="sourceLine" id="cb31-8" data-line-number="8"><span class="kw">title</span>(label)</a></code></pre></div>
<p><img src="0611-mnist_idx_download_files/figure-html/unnamed-chunk-30-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-the-last-test-image" class="section level3">
<h3><span class="header-section-number">1.1.10</span> Plot the last test image</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="co"># next image, index moves from (0L) to (1L), and so on</span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="co"># first image is 0, last image would be 9999</span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3">idx &lt;-<span class="st"> </span><span class="kw">py_len</span>(test_dataset) <span class="op">-</span><span class="st"> </span>1L</a>
<a class="sourceLine" id="cb32-4" data-line-number="4">.show_img &lt;-<span class="st"> </span>test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(idx)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">numpy</span>()</a>
<a class="sourceLine" id="cb32-5" data-line-number="5">show_img  &lt;-<span class="st"> </span>np<span class="op">$</span><span class="kw">reshape</span>(.show_img, <span class="kw">c</span>(28L, 28L))</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">label     &lt;-<span class="st"> </span>test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(idx)[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb32-7" data-line-number="7"></a>
<a class="sourceLine" id="cb32-8" data-line-number="8"><span class="kw">image</span>(<span class="kw">rotate</span>(show_img), <span class="dt">col =</span> <span class="kw">gray.colors</span>(<span class="dv">64</span>))</a>
<a class="sourceLine" id="cb32-9" data-line-number="9"><span class="kw">title</span>(label)</a></code></pre></div>
<p><img src="0611-mnist_idx_download_files/figure-html/unnamed-chunk-31-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="defining-epochs" class="section level2">
<h2><span class="header-section-number">1.2</span> Defining epochs</h2>
<p>When the model goes through the whole 60k images once, learning how to classify 0-9, itâ€™s consider <strong>1 epoch</strong>.</p>
<p>However, thereâ€™s a concept of batch size where it means the model would look at 100 images before updating the modelâ€™s weights, thereby learning. When the model updates its weights (parameters) after looking at all the images, this is considered 1 iteration.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">batch_size &lt;-<span class="st"> </span>100L</a></code></pre></div>
<p>We arbitrarily set 3000 iterations here which means the model would update 3000 times.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">n_iters &lt;-<span class="st"> </span>3000L</a></code></pre></div>
<p>One epoch consists of 60,000 / 100 = 600 iterations. Because we would like to go through 3000 iterations, this implies we would have 3000 / 600 = 5 epochs as each epoch has 600 iterations.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">num_epochs =<span class="st"> </span>n_iters <span class="op">/</span><span class="st"> </span>(<span class="kw">py_len</span>(train_dataset) <span class="op">/</span><span class="st"> </span>batch_size)</a>
<a class="sourceLine" id="cb35-2" data-line-number="2">num_epochs =<span class="st"> </span><span class="kw">as.integer</span>(num_epochs)</a>
<a class="sourceLine" id="cb35-3" data-line-number="3">num_epochs</a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="co">#&gt; [1] 5</span></a></code></pre></div>
</div>
<div id="create-iterable-objects-training-and-testing-dataset" class="section level2">
<h2><span class="header-section-number">1.3</span> Create iterable objects: training and testing dataset</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">train_loader =<span class="st"> </span>torch<span class="op">$</span>utils<span class="op">$</span>data<span class="op">$</span><span class="kw">DataLoader</span>(<span class="dt">dataset=</span>train_dataset, </a>
<a class="sourceLine" id="cb36-2" data-line-number="2">                                           <span class="dt">batch_size=</span>batch_size, </a>
<a class="sourceLine" id="cb36-3" data-line-number="3">                                           <span class="dt">shuffle=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co"># Iterable object</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2">test_loader =<span class="st"> </span>torch<span class="op">$</span>utils<span class="op">$</span>data<span class="op">$</span><span class="kw">DataLoader</span>(<span class="dt">dataset=</span>test_dataset, </a>
<a class="sourceLine" id="cb37-3" data-line-number="3">                                          <span class="dt">batch_size=</span>batch_size, </a>
<a class="sourceLine" id="cb37-4" data-line-number="4">                                          <span class="dt">shuffle=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<div id="check-iteraibility" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Check iteraibility</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">collections &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;collections&quot;</span>)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"></a>
<a class="sourceLine" id="cb38-3" data-line-number="3">builtins<span class="op">$</span><span class="kw">isinstance</span>(train_loader, collections<span class="op">$</span>Iterable)</a>
<a class="sourceLine" id="cb38-4" data-line-number="4"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb38-5" data-line-number="5">builtins<span class="op">$</span><span class="kw">isinstance</span>(test_loader, collections<span class="op">$</span>Iterable)</a>
<a class="sourceLine" id="cb38-6" data-line-number="6"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
</div>
</div>
<div id="building-the-model" class="section level2">
<h2><span class="header-section-number">1.4</span> Building the model</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co"># Same as linear regression! </span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2">main &lt;-<span class="st"> </span><span class="kw">py_run_string</span>(</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="st">import torch.nn as nn</span></a>
<a class="sourceLine" id="cb39-5" data-line-number="5"></a>
<a class="sourceLine" id="cb39-6" data-line-number="6"><span class="st">class LogisticRegressionModel(nn.Module):</span></a>
<a class="sourceLine" id="cb39-7" data-line-number="7"><span class="st">    def __init__(self, input_dim, output_dim):</span></a>
<a class="sourceLine" id="cb39-8" data-line-number="8"><span class="st">        super(LogisticRegressionModel, self).__init__()</span></a>
<a class="sourceLine" id="cb39-9" data-line-number="9"><span class="st">        self.linear = nn.Linear(input_dim, output_dim)</span></a>
<a class="sourceLine" id="cb39-10" data-line-number="10"></a>
<a class="sourceLine" id="cb39-11" data-line-number="11"><span class="st">    def forward(self, x):</span></a>
<a class="sourceLine" id="cb39-12" data-line-number="12"><span class="st">        out = self.linear(x)</span></a>
<a class="sourceLine" id="cb39-13" data-line-number="13"><span class="st">        return out</span></a>
<a class="sourceLine" id="cb39-14" data-line-number="14"><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb39-15" data-line-number="15"></a>
<a class="sourceLine" id="cb39-16" data-line-number="16"><span class="co"># build a Linear Rgression model</span></a>
<a class="sourceLine" id="cb39-17" data-line-number="17">LogisticRegressionModel &lt;-<span class="st"> </span>main<span class="op">$</span>LogisticRegressionModel</a></code></pre></div>
<div id="instantiate-model-class-based-on-input-and-out-dimensions" class="section level3">
<h3><span class="header-section-number">1.4.1</span> Instantiate model class based on input and out dimensions</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># feeding the model with 28x28 images</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2">input_dim =<span class="st"> </span>28L<span class="op">*</span>28L</a>
<a class="sourceLine" id="cb40-3" data-line-number="3"></a>
<a class="sourceLine" id="cb40-4" data-line-number="4"><span class="co"># classify digits 0-9 a total of 10 classes,</span></a>
<a class="sourceLine" id="cb40-5" data-line-number="5">output_dim =<span class="st"> </span>10L</a>
<a class="sourceLine" id="cb40-6" data-line-number="6"></a>
<a class="sourceLine" id="cb40-7" data-line-number="7">model =<span class="st"> </span><span class="kw">LogisticRegressionModel</span>(input_dim, output_dim)</a></code></pre></div>
</div>
<div id="instantiate-cross-entropy-loss-class" class="section level3">
<h3><span class="header-section-number">1.4.2</span> Instantiate Cross Entropy Loss class</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="co"># need Cross Entropy Loss to calculate loss before we backpropagation</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2">criterion =<span class="st"> </span>nn<span class="op">$</span><span class="kw">CrossEntropyLoss</span>()  </a></code></pre></div>
</div>
<div id="instantiate-optimizer-class" class="section level3">
<h3><span class="header-section-number">1.4.3</span> Instantiate Optimizer class</h3>
<p>Similar to what weâ€™ve covered above, this calculates the parametersâ€™ gradients and update them subsequently.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co"># calculate parameters&#39; gradients and update</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2">learning_rate =<span class="st"> </span><span class="fl">0.001</span></a>
<a class="sourceLine" id="cb42-3" data-line-number="3"></a>
<a class="sourceLine" id="cb42-4" data-line-number="4">optimizer =<span class="st"> </span>torch<span class="op">$</span>optim<span class="op">$</span><span class="kw">SGD</span>(model<span class="op">$</span><span class="kw">parameters</span>(), <span class="dt">lr=</span>learning_rate)  </a></code></pre></div>
</div>
<div id="parameters-introspection" class="section level3">
<h3><span class="header-section-number">1.4.4</span> Parameters introspection</h3>
<p>Youâ€™ll realize we have 2 sets of parameters, 10x784 which is <span class="math inline">\(A\)</span> and 10x1 which is <span class="math inline">\(b\)</span> in the <span class="math inline">\(y = AX + b\)</span> equation, where <span class="math inline">\(X\)</span> is our input of size 784.</p>
<p>Weâ€™ll go into details subsequently how these parameters interact with our input to produce our 10x1 output.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="co"># Type of parameter object</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="kw">print</span>(model<span class="op">$</span><span class="kw">parameters</span>())</a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="co">#&gt; &lt;generator object Module.parameters at 0x7f457b388200&gt;</span></a>
<a class="sourceLine" id="cb43-4" data-line-number="4">model_parameters &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">list</span>(model<span class="op">$</span><span class="kw">parameters</span>())</a>
<a class="sourceLine" id="cb43-5" data-line-number="5"></a>
<a class="sourceLine" id="cb43-6" data-line-number="6"><span class="co"># Length of parameters</span></a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="kw">print</span>(builtins<span class="op">$</span><span class="kw">len</span>(model_parameters))</a>
<a class="sourceLine" id="cb43-8" data-line-number="8"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb43-9" data-line-number="9"></a>
<a class="sourceLine" id="cb43-10" data-line-number="10"><span class="co"># FC 1 Parameters </span></a>
<a class="sourceLine" id="cb43-11" data-line-number="11">builtins<span class="op">$</span><span class="kw">list</span>(model_parameters)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb43-12" data-line-number="12"><span class="co">#&gt; torch.Size([10, 784])</span></a>
<a class="sourceLine" id="cb43-13" data-line-number="13"></a>
<a class="sourceLine" id="cb43-14" data-line-number="14"><span class="co"># FC 1 Bias Parameters</span></a>
<a class="sourceLine" id="cb43-15" data-line-number="15">builtins<span class="op">$</span><span class="kw">list</span>(model_parameters)[[<span class="dv">2</span>]]<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb43-16" data-line-number="16"><span class="co">#&gt; torch.Size([10])</span></a></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">builtins<span class="op">$</span><span class="kw">len</span>(builtins<span class="op">$</span><span class="kw">list</span>(model<span class="op">$</span><span class="kw">parameters</span>()))</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
</div>
</div>
<div id="train-the-model-and-test-per-epoch" class="section level2">
<h2><span class="header-section-number">1.5</span> Train the model and test per epoch</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">iter =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2"></a>
<a class="sourceLine" id="cb45-3" data-line-number="3"><span class="cf">for</span> (epoch <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>num_epochs) {</a>
<a class="sourceLine" id="cb45-4" data-line-number="4">  iter_train_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(train_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb45-5" data-line-number="5">  <span class="cf">for</span> (obj <span class="cf">in</span> <span class="kw">iterate</span>(iter_train_dataset)) {</a>
<a class="sourceLine" id="cb45-6" data-line-number="6">      <span class="co"># get the tensors for images and labels</span></a>
<a class="sourceLine" id="cb45-7" data-line-number="7">      images &lt;-<span class="st"> </span>obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb45-8" data-line-number="8">      labels &lt;-<span class="st"> </span>obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb45-9" data-line-number="9">      </a>
<a class="sourceLine" id="cb45-10" data-line-number="10">      <span class="co"># Reshape images to (batch_size, input_size)</span></a>
<a class="sourceLine" id="cb45-11" data-line-number="11">      images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb45-12" data-line-number="12">      </a>
<a class="sourceLine" id="cb45-13" data-line-number="13">      <span class="co"># Clear gradients w.r.t. parameters</span></a>
<a class="sourceLine" id="cb45-14" data-line-number="14">      optimizer<span class="op">$</span><span class="kw">zero_grad</span>()</a>
<a class="sourceLine" id="cb45-15" data-line-number="15">      </a>
<a class="sourceLine" id="cb45-16" data-line-number="16">      <span class="co"># Forward pass to get output/logits</span></a>
<a class="sourceLine" id="cb45-17" data-line-number="17">      outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb45-18" data-line-number="18">      </a>
<a class="sourceLine" id="cb45-19" data-line-number="19">      <span class="co"># Calculate Loss: softmax --&gt; cross entropy loss</span></a>
<a class="sourceLine" id="cb45-20" data-line-number="20">      loss =<span class="st"> </span><span class="kw">criterion</span>(outputs, labels)</a>
<a class="sourceLine" id="cb45-21" data-line-number="21">      </a>
<a class="sourceLine" id="cb45-22" data-line-number="22">      <span class="co"># Getting gradients w.r.t. parameters</span></a>
<a class="sourceLine" id="cb45-23" data-line-number="23">      loss<span class="op">$</span><span class="kw">backward</span>()</a>
<a class="sourceLine" id="cb45-24" data-line-number="24">      </a>
<a class="sourceLine" id="cb45-25" data-line-number="25">      <span class="co"># Updating parameters</span></a>
<a class="sourceLine" id="cb45-26" data-line-number="26">      optimizer<span class="op">$</span><span class="kw">step</span>()</a>
<a class="sourceLine" id="cb45-27" data-line-number="27">      </a>
<a class="sourceLine" id="cb45-28" data-line-number="28">      iter =<span class="st"> </span>iter <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb45-29" data-line-number="29">      </a>
<a class="sourceLine" id="cb45-30" data-line-number="30">      <span class="cf">if</span> (iter <span class="op">%%</span><span class="st"> </span><span class="dv">500</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb45-31" data-line-number="31">          <span class="co"># Calculate Accuracy         </span></a>
<a class="sourceLine" id="cb45-32" data-line-number="32">          correct =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb45-33" data-line-number="33">          total =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb45-34" data-line-number="34">          </a>
<a class="sourceLine" id="cb45-35" data-line-number="35">          <span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb45-36" data-line-number="36">          iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb45-37" data-line-number="37">          <span class="cf">for</span> (obj2 <span class="cf">in</span> <span class="kw">iterate</span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb45-38" data-line-number="38">              <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb45-39" data-line-number="39">              images &lt;-<span class="st"> </span>obj2[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb45-40" data-line-number="40">              labels &lt;-<span class="st"> </span>obj2[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb45-41" data-line-number="41">              images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb45-42" data-line-number="42">          </a>
<a class="sourceLine" id="cb45-43" data-line-number="43">              <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb45-44" data-line-number="44">              outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb45-45" data-line-number="45">          </a>
<a class="sourceLine" id="cb45-46" data-line-number="46">              <span class="co"># Get predictions from the maximum value</span></a>
<a class="sourceLine" id="cb45-47" data-line-number="47">              .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw">max</span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb45-48" data-line-number="48">              predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb45-49" data-line-number="49">          </a>
<a class="sourceLine" id="cb45-50" data-line-number="50">              <span class="co"># Total number of labels</span></a>
<a class="sourceLine" id="cb45-51" data-line-number="51">              total =<span class="st"> </span>total <span class="op">+</span><span class="st"> </span>labels<span class="op">$</span><span class="kw">size</span>(0L)</a>
<a class="sourceLine" id="cb45-52" data-line-number="52">          </a>
<a class="sourceLine" id="cb45-53" data-line-number="53">              <span class="co"># Total correct predictions</span></a>
<a class="sourceLine" id="cb45-54" data-line-number="54">              correct =<span class="st"> </span>correct <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>((predicted<span class="op">$</span><span class="kw">numpy</span>() <span class="op">==</span><span class="st"> </span>labels<span class="op">$</span><span class="kw">numpy</span>()))</a>
<a class="sourceLine" id="cb45-55" data-line-number="55">          }</a>
<a class="sourceLine" id="cb45-56" data-line-number="56">          accuracy =<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>correct <span class="op">/</span><span class="st"> </span>total</a>
<a class="sourceLine" id="cb45-57" data-line-number="57">          </a>
<a class="sourceLine" id="cb45-58" data-line-number="58">          <span class="co"># Print Loss</span></a>
<a class="sourceLine" id="cb45-59" data-line-number="59">          <span class="kw">cat</span>(<span class="kw">sprintf</span>(<span class="st">&#39;Iteration: %5d. Loss: %f. Accuracy: %8.2f </span><span class="ch">\n</span><span class="st">&#39;</span>, </a>
<a class="sourceLine" id="cb45-60" data-line-number="60">                      iter, loss<span class="op">$</span><span class="kw">item</span>(), accuracy))</a>
<a class="sourceLine" id="cb45-61" data-line-number="61">      }</a>
<a class="sourceLine" id="cb45-62" data-line-number="62">  }</a>
<a class="sourceLine" id="cb45-63" data-line-number="63">}  </a>
<a class="sourceLine" id="cb45-64" data-line-number="64"><span class="co">#&gt; Iteration:   500. Loss: 1.930394. Accuracy:    65.16 </span></a>
<a class="sourceLine" id="cb45-65" data-line-number="65"><span class="co">#&gt; Iteration:  1000. Loss: 1.664889. Accuracy:    76.85 </span></a>
<a class="sourceLine" id="cb45-66" data-line-number="66"><span class="co">#&gt; Iteration:  1500. Loss: 1.330313. Accuracy:    80.35 </span></a>
<a class="sourceLine" id="cb45-67" data-line-number="67"><span class="co">#&gt; Iteration:  2000. Loss: 1.202632. Accuracy:    81.44 </span></a>
<a class="sourceLine" id="cb45-68" data-line-number="68"><span class="co">#&gt; Iteration:  2500. Loss: 1.112350. Accuracy:    82.48 </span></a>
<a class="sourceLine" id="cb45-69" data-line-number="69"><span class="co">#&gt; Iteration:  3000. Loss: 0.963235. Accuracy:    83.27</span></a></code></pre></div>
</div>
<div id="break-down-accuracy-calculation" class="section level2">
<h2><span class="header-section-number">1.6</span> Break down accuracy calculation</h2>
<p>As weâ€™ve trained our model, we can extract the accuracy calculation portion to understand whatâ€™s happening without re-training the model.</p>
<p>This would print out the output of the modelâ€™s predictions on your notebook.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb46-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw">iterate</span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb46-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb46-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb46-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb46-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb46-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb46-10" data-line-number="10">    </a>
<a class="sourceLine" id="cb46-11" data-line-number="11">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb46-12" data-line-number="12">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb46-13" data-line-number="13">    </a>
<a class="sourceLine" id="cb46-14" data-line-number="14">    <span class="cf">if</span> (iter_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb46-15" data-line-number="15">        <span class="kw">print</span>(<span class="st">&#39;OUTPUTS&#39;</span>)</a>
<a class="sourceLine" id="cb46-16" data-line-number="16">        <span class="kw">print</span>(outputs)</a>
<a class="sourceLine" id="cb46-17" data-line-number="17">    }</a>
<a class="sourceLine" id="cb46-18" data-line-number="18">    <span class="co"># Get predictions from the maximum value</span></a>
<a class="sourceLine" id="cb46-19" data-line-number="19">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw">max</span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb46-20" data-line-number="20">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb46-21" data-line-number="21">}</a>
<a class="sourceLine" id="cb46-22" data-line-number="22"><span class="co">#&gt; [1] &quot;OUTPUTS&quot;</span></a>
<a class="sourceLine" id="cb46-23" data-line-number="23"><span class="co">#&gt; tensor([[-4.4718e-01, -1.2468e+00, -2.0423e-01, -2.0565e-01,  4.9760e-02,</span></a>
<a class="sourceLine" id="cb46-24" data-line-number="24"><span class="co">#&gt;          -4.3313e-01, -1.0500e+00,  2.8732e+00, -1.7834e-01,  8.9531e-01],</span></a>
<a class="sourceLine" id="cb46-25" data-line-number="25"><span class="co">#&gt;         [ 3.9692e-01,  1.8405e-01,  1.3228e+00,  1.0296e+00, -1.4375e+00,</span></a>
<a class="sourceLine" id="cb46-26" data-line-number="26"><span class="co">#&gt;           9.6043e-01,  1.2506e+00, -2.0427e+00,  5.8836e-01, -1.6811e+00],</span></a>
<a class="sourceLine" id="cb46-27" data-line-number="27"><span class="co">#&gt;         [-9.9751e-01,  2.1629e+00,  3.9952e-01, -3.6541e-02, -6.3222e-01,</span></a>
<a class="sourceLine" id="cb46-28" data-line-number="28"><span class="co">#&gt;          -4.0809e-01, -5.4612e-02, -1.7367e-01,  1.9773e-01, -4.0278e-01],</span></a>
<a class="sourceLine" id="cb46-29" data-line-number="29"><span class="co">#&gt;         [ 2.9793e+00, -2.3172e+00, -1.5949e-01, -4.7658e-01, -9.7048e-01,</span></a>
<a class="sourceLine" id="cb46-30" data-line-number="30"><span class="co">#&gt;           3.5469e-01,  1.0783e+00,  2.5707e-01, -7.1833e-01, -2.8411e-01],</span></a>
<a class="sourceLine" id="cb46-31" data-line-number="31"><span class="co">#&gt;         [-2.2573e-01, -2.1043e+00,  4.9942e-01, -4.8008e-01,  1.7810e+00,</span></a>
<a class="sourceLine" id="cb46-32" data-line-number="32"><span class="co">#&gt;          -5.2401e-01,  1.9287e-01,  2.6184e-01,  6.8635e-02,  7.9822e-01],</span></a>
<a class="sourceLine" id="cb46-33" data-line-number="33"><span class="co">#&gt;         [-1.4478e+00,  2.7352e+00,  3.2370e-01,  2.1585e-01, -7.5771e-01,</span></a>
<a class="sourceLine" id="cb46-34" data-line-number="34"><span class="co">#&gt;          -5.8821e-01, -6.3140e-01,  4.4991e-02,  4.9383e-01, -2.5457e-01],</span></a>
<a class="sourceLine" id="cb46-35" data-line-number="35"><span class="co">#&gt;         [-1.0588e+00, -1.2620e+00, -6.5725e-01,  2.6055e-01,  1.4758e+00,</span></a>
<a class="sourceLine" id="cb46-36" data-line-number="36"><span class="co">#&gt;           2.3970e-01, -7.7276e-01,  5.3985e-01,  4.3092e-01,  8.9223e-01],</span></a>
<a class="sourceLine" id="cb46-37" data-line-number="37"><span class="co">#&gt;         [-1.5584e+00, -1.1613e-01, -7.3851e-01, -1.4457e-01,  7.5339e-01,</span></a>
<a class="sourceLine" id="cb46-38" data-line-number="38"><span class="co">#&gt;           3.2954e-01,  4.0229e-01,  2.5227e-02,  7.0832e-02,  1.2668e+00],</span></a>
<a class="sourceLine" id="cb46-39" data-line-number="39"><span class="co">#&gt;         [ 3.0124e-01, -5.5646e-01,  8.9757e-01, -1.1597e+00,  4.4120e-01,</span></a>
<a class="sourceLine" id="cb46-40" data-line-number="40"><span class="co">#&gt;          -9.9473e-02,  5.4231e-01, -8.7245e-01, -2.4963e-01,  1.4820e-01],</span></a>
<a class="sourceLine" id="cb46-41" data-line-number="41"><span class="co">#&gt;         [-5.7911e-01, -8.7807e-01, -9.0174e-01, -1.3825e+00,  9.5467e-01,</span></a>
<a class="sourceLine" id="cb46-42" data-line-number="42"><span class="co">#&gt;          -2.4098e-01, -3.9403e-01,  1.6330e+00, -5.8946e-02,  1.7613e+00],</span></a>
<a class="sourceLine" id="cb46-43" data-line-number="43"><span class="co">#&gt;         [ 3.1051e+00, -1.9428e+00,  6.6167e-01,  8.6285e-01, -9.0445e-01,</span></a>
<a class="sourceLine" id="cb46-44" data-line-number="44"><span class="co">#&gt;           7.9078e-01, -4.4758e-01, -1.4197e+00,  6.4352e-01, -1.9277e+00],</span></a>
<a class="sourceLine" id="cb46-45" data-line-number="45"><span class="co">#&gt;         [ 8.0887e-01, -3.3479e-01,  5.9968e-01, -2.2933e-01,  3.9940e-01,</span></a>
<a class="sourceLine" id="cb46-46" data-line-number="46"><span class="co">#&gt;          -4.7725e-01,  7.1014e-01, -1.0974e+00,  1.7018e-01, -7.7502e-01],</span></a>
<a class="sourceLine" id="cb46-47" data-line-number="47"><span class="co">#&gt;         [-9.1517e-01, -1.5163e+00, -7.1221e-01, -1.2070e+00,  1.4432e+00,</span></a>
<a class="sourceLine" id="cb46-48" data-line-number="48"><span class="co">#&gt;          -4.8755e-02, -2.1018e-01,  1.2437e+00,  2.2598e-01,  2.0394e+00],</span></a>
<a class="sourceLine" id="cb46-49" data-line-number="49"><span class="co">#&gt;         [ 2.9048e+00, -2.3186e+00, -1.8192e-01, -5.1522e-01, -3.7509e-01,</span></a>
<a class="sourceLine" id="cb46-50" data-line-number="50"><span class="co">#&gt;           6.0079e-01, -4.5564e-01, -5.7541e-01,  5.8529e-01, -3.5066e-02],</span></a>
<a class="sourceLine" id="cb46-51" data-line-number="51"><span class="co">#&gt;         [-1.3704e+00,  2.7397e+00,  5.9176e-02,  4.3453e-01, -1.1104e+00,</span></a>
<a class="sourceLine" id="cb46-52" data-line-number="52"><span class="co">#&gt;          -6.1452e-02, -1.1429e-01, -8.6372e-02,  2.8079e-01, -2.5751e-01],</span></a>
<a class="sourceLine" id="cb46-53" data-line-number="53"><span class="co">#&gt;         [ 3.3053e-01, -8.3779e-01, -1.0540e-02,  1.3105e+00, -5.3815e-01,</span></a>
<a class="sourceLine" id="cb46-54" data-line-number="54"><span class="co">#&gt;           8.2157e-01, -1.4329e-01, -5.0031e-01,  7.6549e-01, -8.0572e-01],</span></a>
<a class="sourceLine" id="cb46-55" data-line-number="55"><span class="co">#&gt;         [-3.5437e-01, -2.1260e+00,  1.8429e-01, -5.7864e-01,  1.4763e+00,</span></a>
<a class="sourceLine" id="cb46-56" data-line-number="56"><span class="co">#&gt;          -7.6180e-01, -2.3951e-01,  8.6812e-01,  1.8640e-01,  1.5885e+00],</span></a>
<a class="sourceLine" id="cb46-57" data-line-number="57"><span class="co">#&gt;         [ 1.6172e-01, -1.4986e+00, -3.7321e-01,  4.8318e-01, -1.6308e-01,</span></a>
<a class="sourceLine" id="cb46-58" data-line-number="58"><span class="co">#&gt;          -3.2916e-01, -7.8972e-01,  2.7884e+00, -4.1788e-01,  5.4859e-01],</span></a>
<a class="sourceLine" id="cb46-59" data-line-number="59"><span class="co">#&gt;         [-6.8135e-01, -3.0668e-01, -1.1400e-01,  1.1116e+00, -4.5003e-01,</span></a>
<a class="sourceLine" id="cb46-60" data-line-number="60"><span class="co">#&gt;           3.6586e-01,  1.1125e+00, -7.2670e-01,  3.5235e-01, -6.2756e-01],</span></a>
<a class="sourceLine" id="cb46-61" data-line-number="61"><span class="co">#&gt;         [-1.1001e+00, -1.3404e+00, -4.0028e-01, -1.2612e-01,  1.9166e+00,</span></a>
<a class="sourceLine" id="cb46-62" data-line-number="62"><span class="co">#&gt;           1.4572e-01, -1.2042e-01,  1.4169e-02, -6.7446e-02,  1.4080e+00],</span></a>
<a class="sourceLine" id="cb46-63" data-line-number="63"><span class="co">#&gt;         [-9.7837e-01, -3.5000e-01, -1.4249e+00,  2.8612e-02,  5.2230e-01,</span></a>
<a class="sourceLine" id="cb46-64" data-line-number="64"><span class="co">#&gt;           2.2429e-01, -1.1744e+00,  1.5846e+00,  1.7682e-01,  1.3263e+00],</span></a>
<a class="sourceLine" id="cb46-65" data-line-number="65"><span class="co">#&gt;         [-6.5477e-01, -1.5491e+00, -7.0765e-02,  9.0579e-02,  3.3517e-01,</span></a>
<a class="sourceLine" id="cb46-66" data-line-number="66"><span class="co">#&gt;           7.5842e-01,  2.3208e+00, -1.5609e+00,  9.5555e-02,  1.4646e-01],</span></a>
<a class="sourceLine" id="cb46-67" data-line-number="67"><span class="co">#&gt;         [-2.6069e-01,  1.1823e-02,  6.3756e-01, -6.9845e-01,  9.5082e-01,</span></a>
<a class="sourceLine" id="cb46-68" data-line-number="68"><span class="co">#&gt;          -1.0574e+00,  1.0354e+00, -2.0140e-02, -1.3835e-01, -1.9916e-01],</span></a>
<a class="sourceLine" id="cb46-69" data-line-number="69"><span class="co">#&gt;         [ 1.3539e-02, -1.0339e+00, -6.8834e-01,  1.3298e-01, -2.5272e-01,</span></a>
<a class="sourceLine" id="cb46-70" data-line-number="70"><span class="co">#&gt;           1.2588e+00,  3.4169e-01, -1.0307e+00,  7.4657e-01, -7.5138e-02],</span></a>
<a class="sourceLine" id="cb46-71" data-line-number="71"><span class="co">#&gt;         [-8.6418e-01, -1.0550e+00, -6.2473e-02, -7.9190e-03,  1.3485e+00,</span></a>
<a class="sourceLine" id="cb46-72" data-line-number="72"><span class="co">#&gt;          -3.3957e-01, -5.4339e-02,  2.6620e-01, -1.5850e-01,  7.9936e-01],</span></a>
<a class="sourceLine" id="cb46-73" data-line-number="73"><span class="co">#&gt;         [ 4.0091e+00, -2.8621e+00,  5.1275e-01, -1.2640e+00, -5.6487e-01,</span></a>
<a class="sourceLine" id="cb46-74" data-line-number="74"><span class="co">#&gt;           5.5093e-01,  9.1637e-01, -8.8556e-01, -2.1351e-01, -1.3818e+00],</span></a>
<a class="sourceLine" id="cb46-75" data-line-number="75"><span class="co">#&gt;         [-1.4768e-01, -1.2759e+00, -4.6839e-01,  2.0196e-01,  2.9679e-01,</span></a>
<a class="sourceLine" id="cb46-76" data-line-number="76"><span class="co">#&gt;          -7.6697e-02, -6.1129e-01,  1.7785e+00, -4.7420e-01,  1.0833e+00],</span></a>
<a class="sourceLine" id="cb46-77" data-line-number="77"><span class="co">#&gt;         [-5.7190e-01, -2.3027e+00, -3.3794e-01, -8.1916e-01,  2.2007e+00,</span></a>
<a class="sourceLine" id="cb46-78" data-line-number="78"><span class="co">#&gt;           1.3461e-01,  1.8284e-01, -8.1112e-02,  5.7235e-02,  1.4458e+00],</span></a>
<a class="sourceLine" id="cb46-79" data-line-number="79"><span class="co">#&gt;         [ 2.7089e+00, -2.3237e+00,  9.4707e-02,  7.7947e-01, -1.2415e+00,</span></a>
<a class="sourceLine" id="cb46-80" data-line-number="80"><span class="co">#&gt;           8.0063e-01, -3.9329e-01, -7.2111e-01,  6.3017e-01, -6.2783e-01],</span></a>
<a class="sourceLine" id="cb46-81" data-line-number="81"><span class="co">#&gt;         [-1.0973e+00,  1.4323e+00, -2.1174e-01,  1.4088e-01, -4.8525e-01,</span></a>
<a class="sourceLine" id="cb46-82" data-line-number="82"><span class="co">#&gt;           3.1773e-01,  2.0053e-01, -9.9906e-02,  2.0743e-01, -2.2311e-01],</span></a>
<a class="sourceLine" id="cb46-83" data-line-number="83"><span class="co">#&gt;         [-8.4590e-01, -1.0016e-01, -8.6598e-01,  2.2519e+00, -1.2618e+00,</span></a>
<a class="sourceLine" id="cb46-84" data-line-number="84"><span class="co">#&gt;           8.4650e-01, -1.5320e-01,  3.0204e-01,  4.9887e-02, -2.8661e-01],</span></a>
<a class="sourceLine" id="cb46-85" data-line-number="85"><span class="co">#&gt;         [-1.0682e+00,  1.0729e+00, -1.1216e-01,  3.4936e-01, -3.4230e-01,</span></a>
<a class="sourceLine" id="cb46-86" data-line-number="86"><span class="co">#&gt;           2.2077e-01, -8.2051e-02,  1.2824e-01,  2.2942e-01,  1.1629e-01],</span></a>
<a class="sourceLine" id="cb46-87" data-line-number="87"><span class="co">#&gt;         [-9.4899e-01, -5.3057e-01, -5.7026e-01,  2.4066e+00, -3.0957e-01,</span></a>
<a class="sourceLine" id="cb46-88" data-line-number="88"><span class="co">#&gt;           1.5446e+00, -8.6426e-02, -1.0682e+00,  5.4839e-01,  3.3472e-02],</span></a>
<a class="sourceLine" id="cb46-89" data-line-number="89"><span class="co">#&gt;         [ 1.5498e+00, -1.7359e+00,  6.3691e-01, -1.7320e+00,  7.6195e-01,</span></a>
<a class="sourceLine" id="cb46-90" data-line-number="90"><span class="co">#&gt;           1.7419e-01,  1.6346e+00, -8.8359e-01, -2.2536e-01, -2.0428e-01],</span></a>
<a class="sourceLine" id="cb46-91" data-line-number="91"><span class="co">#&gt;         [-9.2637e-01, -4.7381e-01,  9.2078e-01, -3.8526e-01, -1.1131e-01,</span></a>
<a class="sourceLine" id="cb46-92" data-line-number="92"><span class="co">#&gt;          -7.1767e-01, -1.5457e+00,  1.6373e+00,  5.6451e-01,  5.3076e-01],</span></a>
<a class="sourceLine" id="cb46-93" data-line-number="93"><span class="co">#&gt;         [ 2.9096e-01, -1.2399e+00,  2.5253e+00,  1.2543e-01, -9.3077e-01,</span></a>
<a class="sourceLine" id="cb46-94" data-line-number="94"><span class="co">#&gt;          -7.8151e-02,  3.7625e-01, -6.0042e-01,  3.1139e-01, -1.6205e+00],</span></a>
<a class="sourceLine" id="cb46-95" data-line-number="95"><span class="co">#&gt;         [-5.4234e-01, -1.5158e+00,  1.9148e-01, -6.0352e-02, -1.1139e-01,</span></a>
<a class="sourceLine" id="cb46-96" data-line-number="96"><span class="co">#&gt;          -4.1123e-01, -6.5139e-01,  2.3466e+00, -4.2553e-01,  1.1583e+00],</span></a>
<a class="sourceLine" id="cb46-97" data-line-number="97"><span class="co">#&gt;         [-1.3526e+00,  2.0814e+00, -2.5008e-01,  2.4792e-02, -5.8163e-01,</span></a>
<a class="sourceLine" id="cb46-98" data-line-number="98"><span class="co">#&gt;           6.7936e-02, -1.0535e-01,  1.0695e-01,  2.9362e-01, -8.5246e-03],</span></a>
<a class="sourceLine" id="cb46-99" data-line-number="99"><span class="co">#&gt;         [ 1.9078e-01,  5.4378e-01,  8.4019e-01,  1.1426e+00, -1.9290e+00,</span></a>
<a class="sourceLine" id="cb46-100" data-line-number="100"><span class="co">#&gt;           3.7091e-01,  5.2896e-01, -1.1999e+00,  6.3426e-01, -1.4869e+00],</span></a>
<a class="sourceLine" id="cb46-101" data-line-number="101"><span class="co">#&gt;         [-1.3185e+00,  2.9538e+00, -1.3862e-01,  5.1946e-01, -1.1983e+00,</span></a>
<a class="sourceLine" id="cb46-102" data-line-number="102"><span class="co">#&gt;          -5.6529e-02, -1.7690e-01, -4.6838e-01,  6.7856e-01, -3.3835e-01],</span></a>
<a class="sourceLine" id="cb46-103" data-line-number="103"><span class="co">#&gt;         [-6.5727e-01,  1.5232e+00,  9.6108e-02,  6.0365e-02, -5.5318e-01,</span></a>
<a class="sourceLine" id="cb46-104" data-line-number="104"><span class="co">#&gt;          -1.1610e-01, -5.1669e-02, -1.1898e-01,  1.2403e-01, -2.0924e-01],</span></a>
<a class="sourceLine" id="cb46-105" data-line-number="105"><span class="co">#&gt;         [-7.8086e-01, -8.5921e-01, -1.9255e-01, -3.3425e-01,  2.4007e-02,</span></a>
<a class="sourceLine" id="cb46-106" data-line-number="106"><span class="co">#&gt;          -2.0580e-01, -6.2357e-01,  2.0483e+00, -2.8002e-01,  1.4973e+00],</span></a>
<a class="sourceLine" id="cb46-107" data-line-number="107"><span class="co">#&gt;         [-2.1809e+00, -2.5838e-01, -7.2363e-02, -2.4267e-01,  2.0468e+00,</span></a>
<a class="sourceLine" id="cb46-108" data-line-number="108"><span class="co">#&gt;          -7.7054e-01, -8.5603e-01,  6.2093e-01,  3.5206e-01,  1.5995e+00],</span></a>
<a class="sourceLine" id="cb46-109" data-line-number="109"><span class="co">#&gt;         [-4.3523e-01,  8.3631e-01,  9.8384e-01,  1.1996e-01, -9.5900e-02,</span></a>
<a class="sourceLine" id="cb46-110" data-line-number="110"><span class="co">#&gt;          -4.3901e-01,  3.6827e-01, -1.0706e+00,  4.0128e-01, -6.4364e-01],</span></a>
<a class="sourceLine" id="cb46-111" data-line-number="111"><span class="co">#&gt;         [-1.1405e+00,  2.4013e-01,  2.0004e-02,  1.2879e+00, -6.5986e-01,</span></a>
<a class="sourceLine" id="cb46-112" data-line-number="112"><span class="co">#&gt;           5.7140e-01,  5.7954e-01, -3.0499e-01, -4.2171e-02, -3.0109e-01],</span></a>
<a class="sourceLine" id="cb46-113" data-line-number="113"><span class="co">#&gt;         [ 1.4556e-01, -1.0861e+00, -6.8373e-01,  1.5800e+00, -6.2538e-01,</span></a>
<a class="sourceLine" id="cb46-114" data-line-number="114"><span class="co">#&gt;           1.3170e+00,  8.3067e-02, -1.5121e+00,  8.6213e-01, -3.3431e-01],</span></a>
<a class="sourceLine" id="cb46-115" data-line-number="115"><span class="co">#&gt;         [-1.7141e+00,  3.6242e-01,  5.5442e-02,  8.1118e-01, -1.2363e-01,</span></a>
<a class="sourceLine" id="cb46-116" data-line-number="116"><span class="co">#&gt;           5.2943e-01,  2.3864e-01, -4.6302e-02,  2.1998e-01,  2.6361e-01],</span></a>
<a class="sourceLine" id="cb46-117" data-line-number="117"><span class="co">#&gt;         [-6.8859e-01, -1.9947e-01,  1.3936e+00, -4.3002e-01,  4.1049e-01,</span></a>
<a class="sourceLine" id="cb46-118" data-line-number="118"><span class="co">#&gt;          -5.2483e-01,  5.7683e-01, -4.7484e-01, -9.8542e-03,  6.1606e-02],</span></a>
<a class="sourceLine" id="cb46-119" data-line-number="119"><span class="co">#&gt;         [-1.3215e+00, -2.6090e+00, -1.1861e+00,  2.3431e-02,  2.6590e+00,</span></a>
<a class="sourceLine" id="cb46-120" data-line-number="120"><span class="co">#&gt;           3.1867e-01, -6.4302e-01,  2.9892e-01,  6.3076e-01,  2.2543e+00],</span></a>
<a class="sourceLine" id="cb46-121" data-line-number="121"><span class="co">#&gt;         [-5.2516e-01, -1.8418e+00,  6.0105e-01, -4.2228e-01,  2.3761e+00,</span></a>
<a class="sourceLine" id="cb46-122" data-line-number="122"><span class="co">#&gt;          -9.7343e-01,  2.6593e-01,  1.3026e-01, -3.4686e-01,  1.0964e+00],</span></a>
<a class="sourceLine" id="cb46-123" data-line-number="123"><span class="co">#&gt;         [-5.9763e-02, -1.0214e+00,  1.2830e-01,  2.9076e-01, -3.1880e-01,</span></a>
<a class="sourceLine" id="cb46-124" data-line-number="124"><span class="co">#&gt;           4.0005e-01,  2.0851e+00, -1.2715e+00,  1.6089e-02, -4.3198e-01],</span></a>
<a class="sourceLine" id="cb46-125" data-line-number="125"><span class="co">#&gt;         [ 6.1674e-02, -6.0513e-01, -2.9976e-01,  1.7100e+00, -6.0768e-01,</span></a>
<a class="sourceLine" id="cb46-126" data-line-number="126"><span class="co">#&gt;           6.4359e-01,  3.3144e-02, -4.9583e-01, -8.5020e-02, -1.4872e-01],</span></a>
<a class="sourceLine" id="cb46-127" data-line-number="127"><span class="co">#&gt;         [ 4.2600e-01, -1.1501e+00, -1.3824e+00,  4.8415e-02,  6.8784e-01,</span></a>
<a class="sourceLine" id="cb46-128" data-line-number="128"><span class="co">#&gt;           1.1275e+00,  3.2526e-03, -3.7121e-01, -3.1046e-01,  5.7692e-01],</span></a>
<a class="sourceLine" id="cb46-129" data-line-number="129"><span class="co">#&gt;         [ 2.6287e-01, -6.7316e-01, -2.8793e-01,  1.0665e+00, -2.1556e-01,</span></a>
<a class="sourceLine" id="cb46-130" data-line-number="130"><span class="co">#&gt;           7.5585e-01, -1.3331e-01, -7.6487e-01,  3.2164e-01, -4.7666e-01],</span></a>
<a class="sourceLine" id="cb46-131" data-line-number="131"><span class="co">#&gt;         [ 7.0425e-02, -5.7740e-01,  1.4257e+00, -3.6412e-01,  6.0841e-01,</span></a>
<a class="sourceLine" id="cb46-132" data-line-number="132"><span class="co">#&gt;          -8.4833e-01,  6.6877e-01, -7.8570e-01,  1.2101e-01, -3.5506e-01],</span></a>
<a class="sourceLine" id="cb46-133" data-line-number="133"><span class="co">#&gt;         [ 1.4769e+00, -2.0905e+00, -7.5154e-01,  2.1655e-01, -5.0935e-01,</span></a>
<a class="sourceLine" id="cb46-134" data-line-number="134"><span class="co">#&gt;           1.1331e+00,  2.3215e-01, -9.0899e-01,  1.3230e+00, -8.0555e-02],</span></a>
<a class="sourceLine" id="cb46-135" data-line-number="135"><span class="co">#&gt;         [-1.9352e-01, -2.6666e+00,  1.1157e-01, -4.1165e-01,  2.6324e+00,</span></a>
<a class="sourceLine" id="cb46-136" data-line-number="136"><span class="co">#&gt;          -1.4759e-01,  3.6568e-01, -3.5276e-01,  4.8593e-02,  7.8187e-01],</span></a>
<a class="sourceLine" id="cb46-137" data-line-number="137"><span class="co">#&gt;         [-8.9221e-01,  2.3047e+00,  2.1518e-01,  2.6188e-01, -8.3481e-01,</span></a>
<a class="sourceLine" id="cb46-138" data-line-number="138"><span class="co">#&gt;          -3.2789e-01, -4.1367e-01, -4.0623e-02,  3.7693e-01, -2.6286e-01],</span></a>
<a class="sourceLine" id="cb46-139" data-line-number="139"><span class="co">#&gt;         [-2.7419e-01, -1.9066e+00, -7.5488e-01, -9.0709e-01,  1.6777e+00,</span></a>
<a class="sourceLine" id="cb46-140" data-line-number="140"><span class="co">#&gt;          -3.0612e-01, -1.0424e-01,  1.1124e+00, -2.7138e-01,  2.0957e+00],</span></a>
<a class="sourceLine" id="cb46-141" data-line-number="141"><span class="co">#&gt;         [-1.3851e-01,  2.7365e-01, -4.9187e-01, -3.6332e-01,  2.4250e-01,</span></a>
<a class="sourceLine" id="cb46-142" data-line-number="142"><span class="co">#&gt;           3.7286e-01, -6.8500e-02,  4.2384e-01,  4.5608e-02, -1.5793e-01],</span></a>
<a class="sourceLine" id="cb46-143" data-line-number="143"><span class="co">#&gt;         [-2.3738e-01, -1.4720e+00, -7.5517e-01,  9.6357e-01,  4.9134e-01,</span></a>
<a class="sourceLine" id="cb46-144" data-line-number="144"><span class="co">#&gt;           7.1542e-02, -1.9931e-01,  2.1386e+00, -4.6620e-01,  7.3949e-01],</span></a>
<a class="sourceLine" id="cb46-145" data-line-number="145"><span class="co">#&gt;         [ 3.8759e-02, -8.3677e-01,  9.2317e-01, -1.6138e+00, -9.7517e-02,</span></a>
<a class="sourceLine" id="cb46-146" data-line-number="146"><span class="co">#&gt;           1.8657e-01,  5.3202e-01, -6.8962e-01,  1.1442e+00,  2.5980e-01],</span></a>
<a class="sourceLine" id="cb46-147" data-line-number="147"><span class="co">#&gt;         [-8.0620e-01, -9.0926e-01,  1.2432e-01, -2.7728e-01,  7.7447e-01,</span></a>
<a class="sourceLine" id="cb46-148" data-line-number="148"><span class="co">#&gt;           1.2153e-01,  1.0216e-01, -5.0359e-02,  4.8220e-01,  9.2443e-01],</span></a>
<a class="sourceLine" id="cb46-149" data-line-number="149"><span class="co">#&gt;         [-7.5812e-01, -1.5325e-01,  1.2925e+00,  7.4748e-01,  3.0094e-02,</span></a>
<a class="sourceLine" id="cb46-150" data-line-number="150"><span class="co">#&gt;           1.3638e-01, -4.2398e-01, -5.9170e-01,  4.1177e-01,  1.7426e-01],</span></a>
<a class="sourceLine" id="cb46-151" data-line-number="151"><span class="co">#&gt;         [-1.0049e+00, -6.0475e-01,  3.7886e-01, -6.3298e-01,  7.2543e-01,</span></a>
<a class="sourceLine" id="cb46-152" data-line-number="152"><span class="co">#&gt;          -7.9102e-01, -6.2105e-01,  1.4978e+00,  1.1697e-01,  5.8643e-01],</span></a>
<a class="sourceLine" id="cb46-153" data-line-number="153"><span class="co">#&gt;         [-1.1528e+00, -5.6782e-01, -5.2434e-01,  5.1987e-01,  5.7555e-01,</span></a>
<a class="sourceLine" id="cb46-154" data-line-number="154"><span class="co">#&gt;           6.6608e-01,  1.5166e-01, -2.7806e-01,  5.9166e-01,  8.2105e-01],</span></a>
<a class="sourceLine" id="cb46-155" data-line-number="155"><span class="co">#&gt;         [ 4.1861e-01, -3.5938e-01,  8.0857e-01, -2.0490e-01,  2.2257e-01,</span></a>
<a class="sourceLine" id="cb46-156" data-line-number="156"><span class="co">#&gt;          -7.9776e-01,  5.9117e-01,  6.2306e-02, -3.1427e-01, -7.2222e-01],</span></a>
<a class="sourceLine" id="cb46-157" data-line-number="157"><span class="co">#&gt;         [-7.1386e-01, -1.5529e+00,  5.5837e-01, -7.6247e-01,  2.0723e+00,</span></a>
<a class="sourceLine" id="cb46-158" data-line-number="158"><span class="co">#&gt;          -8.3456e-01, -1.5104e-01,  4.7445e-01,  1.5284e-01,  7.4672e-01],</span></a>
<a class="sourceLine" id="cb46-159" data-line-number="159"><span class="co">#&gt;         [-1.4449e+00, -2.0144e-01, -3.0553e-01,  2.7222e+00, -5.0228e-01,</span></a>
<a class="sourceLine" id="cb46-160" data-line-number="160"><span class="co">#&gt;           9.1544e-01, -7.1420e-01, -8.1575e-01,  1.0112e+00,  1.0868e-01],</span></a>
<a class="sourceLine" id="cb46-161" data-line-number="161"><span class="co">#&gt;         [ 2.4134e+00, -1.4388e+00,  5.2374e-01, -7.8384e-01, -1.4551e+00,</span></a>
<a class="sourceLine" id="cb46-162" data-line-number="162"><span class="co">#&gt;           4.6627e-01,  3.9831e-01, -1.2101e-01, -5.1153e-01, -4.7996e-01],</span></a>
<a class="sourceLine" id="cb46-163" data-line-number="163"><span class="co">#&gt;         [ 3.3630e-01, -1.1722e+00, -8.2107e-01,  4.1387e-02, -4.6085e-02,</span></a>
<a class="sourceLine" id="cb46-164" data-line-number="164"><span class="co">#&gt;          -2.4157e-01, -6.9715e-01,  2.8333e+00, -3.2066e-01,  5.0198e-01],</span></a>
<a class="sourceLine" id="cb46-165" data-line-number="165"><span class="co">#&gt;         [ 4.2487e+00, -2.9074e+00,  7.6584e-01,  1.5551e-01, -1.1384e+00,</span></a>
<a class="sourceLine" id="cb46-166" data-line-number="166"><span class="co">#&gt;           7.4189e-01,  5.0971e-02, -1.6840e+00,  3.4597e-01, -1.7573e+00],</span></a>
<a class="sourceLine" id="cb46-167" data-line-number="167"><span class="co">#&gt;         [ 1.1821e+00, -1.3790e+00,  1.9817e+00,  1.2842e+00, -1.0030e+00,</span></a>
<a class="sourceLine" id="cb46-168" data-line-number="168"><span class="co">#&gt;          -4.0824e-02,  3.7487e-01, -1.1415e+00,  3.6272e-01, -1.8491e+00],</span></a>
<a class="sourceLine" id="cb46-169" data-line-number="169"><span class="co">#&gt;         [-1.4216e+00,  7.9607e-01,  2.3513e-01, -7.5882e-02, -8.3529e-01,</span></a>
<a class="sourceLine" id="cb46-170" data-line-number="170"><span class="co">#&gt;          -5.0411e-01, -1.1313e+00,  7.2496e-01,  1.1474e+00,  5.9806e-01],</span></a>
<a class="sourceLine" id="cb46-171" data-line-number="171"><span class="co">#&gt;         [-1.2933e+00,  2.4197e+00, -2.4266e-01,  6.4332e-03, -9.0563e-01,</span></a>
<a class="sourceLine" id="cb46-172" data-line-number="172"><span class="co">#&gt;           1.3652e-01, -5.4754e-02, -1.6740e-02,  4.9035e-01, -1.1895e-01],</span></a>
<a class="sourceLine" id="cb46-173" data-line-number="173"><span class="co">#&gt;         [-1.9556e+00,  7.0594e-01, -5.8684e-01, -4.6060e-01,  9.5170e-01,</span></a>
<a class="sourceLine" id="cb46-174" data-line-number="174"><span class="co">#&gt;          -6.2083e-01, -7.1635e-01,  1.8651e+00,  5.7012e-02,  7.3446e-01],</span></a>
<a class="sourceLine" id="cb46-175" data-line-number="175"><span class="co">#&gt;         [-4.6137e-01,  2.4577e-01, -4.2735e-01,  2.3457e+00, -9.3308e-01,</span></a>
<a class="sourceLine" id="cb46-176" data-line-number="176"><span class="co">#&gt;           1.0440e+00, -4.7822e-01, -1.0964e+00,  5.1578e-01, -7.8293e-01],</span></a>
<a class="sourceLine" id="cb46-177" data-line-number="177"><span class="co">#&gt;         [-8.3095e-01, -3.1335e-01,  6.8333e-01, -6.5840e-01, -1.6188e-01,</span></a>
<a class="sourceLine" id="cb46-178" data-line-number="178"><span class="co">#&gt;          -5.4308e-01, -1.0843e-01,  1.5766e+00, -3.0622e-01,  5.3792e-01],</span></a>
<a class="sourceLine" id="cb46-179" data-line-number="179"><span class="co">#&gt;         [-1.5588e+00,  9.7683e-01, -5.7430e-01,  1.2733e-01,  1.1985e-02,</span></a>
<a class="sourceLine" id="cb46-180" data-line-number="180"><span class="co">#&gt;           1.1834e-01, -5.4369e-01,  3.0420e-01,  8.6740e-01,  7.8307e-01],</span></a>
<a class="sourceLine" id="cb46-181" data-line-number="181"><span class="co">#&gt;         [-6.7019e-01, -6.8960e-01, -6.1483e-01, -1.0952e+00, -6.4927e-02,</span></a>
<a class="sourceLine" id="cb46-182" data-line-number="182"><span class="co">#&gt;          -4.8818e-01, -1.4076e+00,  3.2018e+00,  2.5664e-01,  9.1204e-01],</span></a>
<a class="sourceLine" id="cb46-183" data-line-number="183"><span class="co">#&gt;         [-6.4890e-01, -1.5371e+00, -1.1082e+00,  9.4802e-03,  9.5356e-01,</span></a>
<a class="sourceLine" id="cb46-184" data-line-number="184"><span class="co">#&gt;           4.1426e-01, -7.4561e-02,  1.3728e+00, -5.2468e-01,  1.6284e+00],</span></a>
<a class="sourceLine" id="cb46-185" data-line-number="185"><span class="co">#&gt;         [-1.4464e-01, -1.9196e+00,  5.0971e-01, -7.0371e-01,  1.9079e-01,</span></a>
<a class="sourceLine" id="cb46-186" data-line-number="186"><span class="co">#&gt;           1.7855e-01,  2.2777e+00, -5.5766e-01, -4.1643e-01,  2.2053e-01],</span></a>
<a class="sourceLine" id="cb46-187" data-line-number="187"><span class="co">#&gt;         [-7.4571e-01, -1.2401e+00,  3.8547e+00, -2.2660e-03, -2.0006e-01,</span></a>
<a class="sourceLine" id="cb46-188" data-line-number="188"><span class="co">#&gt;          -1.2234e+00,  9.5088e-01, -1.0268e+00,  6.0097e-01, -1.1153e+00],</span></a>
<a class="sourceLine" id="cb46-189" data-line-number="189"><span class="co">#&gt;         [-4.2298e-01, -1.7918e+00, -4.7802e-01,  9.2942e-02,  8.0780e-01,</span></a>
<a class="sourceLine" id="cb46-190" data-line-number="190"><span class="co">#&gt;          -1.5640e-01, -7.1729e-01,  2.1380e+00, -2.9940e-01,  1.5633e+00],</span></a>
<a class="sourceLine" id="cb46-191" data-line-number="191"><span class="co">#&gt;         [-7.9096e-01,  1.2363e-01, -4.1729e-01, -4.6539e-01,  6.7843e-01,</span></a>
<a class="sourceLine" id="cb46-192" data-line-number="192"><span class="co">#&gt;           5.4638e-01, -5.2910e-01, -7.9840e-01,  1.1020e+00,  7.6241e-01],</span></a>
<a class="sourceLine" id="cb46-193" data-line-number="193"><span class="co">#&gt;         [-1.0718e+00, -2.4077e+00, -6.5038e-01,  2.7858e-01,  2.8280e+00,</span></a>
<a class="sourceLine" id="cb46-194" data-line-number="194"><span class="co">#&gt;           1.6169e-01, -1.8347e-01, -5.0920e-01,  2.6854e-01,  1.4414e+00],</span></a>
<a class="sourceLine" id="cb46-195" data-line-number="195"><span class="co">#&gt;         [-1.8737e+00,  4.4057e-01, -2.3574e-01, -6.9661e-01, -5.7052e-02,</span></a>
<a class="sourceLine" id="cb46-196" data-line-number="196"><span class="co">#&gt;          -8.6405e-01, -1.1220e+00,  2.9609e+00,  2.4298e-01,  1.1746e+00],</span></a>
<a class="sourceLine" id="cb46-197" data-line-number="197"><span class="co">#&gt;         [ 2.2905e-02, -1.3900e+00, -1.0668e+00,  1.8178e+00, -2.5003e-01,</span></a>
<a class="sourceLine" id="cb46-198" data-line-number="198"><span class="co">#&gt;           1.3210e+00,  6.9670e-01, -4.9706e-01,  1.5064e-02, -1.0484e-01],</span></a>
<a class="sourceLine" id="cb46-199" data-line-number="199"><span class="co">#&gt;         [-1.9512e-01, -2.0620e+00,  7.2796e-01, -1.2614e+00,  1.1771e+00,</span></a>
<a class="sourceLine" id="cb46-200" data-line-number="200"><span class="co">#&gt;          -4.4560e-01,  2.4300e+00, -2.5322e-01, -5.0160e-01,  3.4287e-01],</span></a>
<a class="sourceLine" id="cb46-201" data-line-number="201"><span class="co">#&gt;         [-1.7895e+00,  2.9237e+00,  5.5602e-01,  1.6005e-02, -6.8446e-01,</span></a>
<a class="sourceLine" id="cb46-202" data-line-number="202"><span class="co">#&gt;          -5.6196e-01, -3.0825e-01, -3.1230e-01,  5.3515e-01, -5.1871e-01],</span></a>
<a class="sourceLine" id="cb46-203" data-line-number="203"><span class="co">#&gt;         [ 1.2778e-01, -5.7787e-01, -2.3668e-01,  2.7850e+00, -1.2496e+00,</span></a>
<a class="sourceLine" id="cb46-204" data-line-number="204"><span class="co">#&gt;           7.2172e-01, -1.2078e+00, -4.5979e-01,  6.6433e-01, -6.4656e-01],</span></a>
<a class="sourceLine" id="cb46-205" data-line-number="205"><span class="co">#&gt;         [-1.1795e+00, -7.7226e-01,  5.4593e-01, -8.4331e-01,  3.5793e-01,</span></a>
<a class="sourceLine" id="cb46-206" data-line-number="206"><span class="co">#&gt;           1.4168e-02,  2.6910e+00, -1.3148e+00,  1.4298e-01,  2.4178e-01],</span></a>
<a class="sourceLine" id="cb46-207" data-line-number="207"><span class="co">#&gt;         [-7.0872e-01,  7.4130e-02,  1.4030e-01, -5.7927e-01,  5.9689e-01,</span></a>
<a class="sourceLine" id="cb46-208" data-line-number="208"><span class="co">#&gt;          -1.3790e-01, -2.6661e-01, -6.8908e-02,  6.6680e-01,  2.8735e-01],</span></a>
<a class="sourceLine" id="cb46-209" data-line-number="209"><span class="co">#&gt;         [-9.4736e-01, -3.8082e-01, -8.1021e-01,  2.5420e+00, -1.4745e+00,</span></a>
<a class="sourceLine" id="cb46-210" data-line-number="210"><span class="co">#&gt;           1.1623e+00, -9.1971e-01,  5.8198e-01,  4.8797e-01, -6.0779e-02],</span></a>
<a class="sourceLine" id="cb46-211" data-line-number="211"><span class="co">#&gt;         [-2.1313e+00,  1.6627e+00, -6.2109e-02,  1.8626e-01, -4.9098e-01,</span></a>
<a class="sourceLine" id="cb46-212" data-line-number="212"><span class="co">#&gt;           3.1607e-01,  3.0959e-01, -2.9732e-01,  8.1288e-01,  6.6196e-02],</span></a>
<a class="sourceLine" id="cb46-213" data-line-number="213"><span class="co">#&gt;         [-9.3417e-01, -5.4787e-01, -2.9066e-01, -1.3079e+00,  2.1613e+00,</span></a>
<a class="sourceLine" id="cb46-214" data-line-number="214"><span class="co">#&gt;          -5.5043e-01,  2.7881e-01, -3.1916e-02, -4.8963e-02,  1.4018e+00],</span></a>
<a class="sourceLine" id="cb46-215" data-line-number="215"><span class="co">#&gt;         [-1.1491e+00,  4.5298e-01, -2.4254e-01,  3.1110e-01, -1.0758e-01,</span></a>
<a class="sourceLine" id="cb46-216" data-line-number="216"><span class="co">#&gt;           4.3531e-01, -9.7760e-02,  7.9330e-02,  4.1125e-01,  2.2789e-01],</span></a>
<a class="sourceLine" id="cb46-217" data-line-number="217"><span class="co">#&gt;         [-1.8481e+00,  1.6300e+00, -5.0357e-01,  1.6786e-01, -1.3542e-01,</span></a>
<a class="sourceLine" id="cb46-218" data-line-number="218"><span class="co">#&gt;          -1.5521e-01, -1.1403e-02,  6.9099e-01,  2.5018e-01,  4.9468e-01],</span></a>
<a class="sourceLine" id="cb46-219" data-line-number="219"><span class="co">#&gt;         [ 7.5237e-01, -1.2569e+00,  6.4591e-01, -9.2931e-01, -3.4462e-01,</span></a>
<a class="sourceLine" id="cb46-220" data-line-number="220"><span class="co">#&gt;           4.9351e-01,  1.8210e+00, -1.1082e+00, -1.1965e-01, -3.3728e-01],</span></a>
<a class="sourceLine" id="cb46-221" data-line-number="221"><span class="co">#&gt;         [-1.2128e+00, -1.6614e+00,  6.5734e-02, -4.0805e-01,  1.6226e+00,</span></a>
<a class="sourceLine" id="cb46-222" data-line-number="222"><span class="co">#&gt;          -8.9240e-01, -3.6762e-01,  8.9544e-01,  4.9617e-02,  2.1655e+00]],</span></a>
<a class="sourceLine" id="cb46-223" data-line-number="223"><span class="co">#&gt;        grad_fn=&lt;AddmmBackward&gt;)</span></a>
<a class="sourceLine" id="cb46-224" data-line-number="224"><span class="kw">print</span>(predicted)</a>
<a class="sourceLine" id="cb46-225" data-line-number="225"><span class="co">#&gt; tensor([8, 9, 0, 8, 2, 7, 4, 8, 6, 7, 8, 0, 8, 2, 9, 4, 7, 8, 4, 7, 8, 6, 4, 1,</span></a>
<a class="sourceLine" id="cb46-226" data-line-number="226"><span class="co">#&gt;         4, 2, 2, 4, 4, 7, 0, 1, 9, 2, 8, 7, 8, 2, 6, 0, 0, 6, 3, 8, 8, 9, 1, 4,</span></a>
<a class="sourceLine" id="cb46-227" data-line-number="227"><span class="co">#&gt;         0, 6, 1, 0, 0, 0, 0, 8, 1, 7, 7, 1, 4, 6, 0, 7, 0, 3, 6, 8, 7, 1, 3, 2,</span></a>
<a class="sourceLine" id="cb46-228" data-line-number="228"><span class="co">#&gt;         4, 4, 4, 2, 6, 4, 1, 7, 2, 6, 6, 0, 1, 7, 3, 4, 5, 6, 7, 8, 4, 0, 1, 2,</span></a>
<a class="sourceLine" id="cb46-229" data-line-number="229"><span class="co">#&gt;         3, 4, 1, 6])</span></a></code></pre></div>
<div id="printing-output-size" class="section level3">
<h3><span class="header-section-number">1.6.1</span> Printing output size</h3>
<p>This produces a 100x10 matrix because each iteration has a batch size of 100 and each prediction across the 10 classes, with the largest number indicating the likely number it is predicting.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb47-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb47-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb47-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw">iterate</span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb47-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb47-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb47-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb47-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb47-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb47-10" data-line-number="10">    </a>
<a class="sourceLine" id="cb47-11" data-line-number="11">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb47-12" data-line-number="12">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb47-13" data-line-number="13">    </a>
<a class="sourceLine" id="cb47-14" data-line-number="14">    <span class="cf">if</span> (iter_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb47-15" data-line-number="15">        <span class="kw">print</span>(<span class="st">&#39;OUTPUTS&#39;</span>)</a>
<a class="sourceLine" id="cb47-16" data-line-number="16">        <span class="kw">print</span>(outputs<span class="op">$</span><span class="kw">size</span>())</a>
<a class="sourceLine" id="cb47-17" data-line-number="17">    }</a>
<a class="sourceLine" id="cb47-18" data-line-number="18">    <span class="co"># Get predictions from the maximum value</span></a>
<a class="sourceLine" id="cb47-19" data-line-number="19">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw">max</span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb47-20" data-line-number="20">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb47-21" data-line-number="21">}</a>
<a class="sourceLine" id="cb47-22" data-line-number="22"><span class="co">#&gt; [1] &quot;OUTPUTS&quot;</span></a>
<a class="sourceLine" id="cb47-23" data-line-number="23"><span class="co">#&gt; torch.Size([100, 10])</span></a>
<a class="sourceLine" id="cb47-24" data-line-number="24"><span class="kw">print</span>(predicted<span class="op">$</span><span class="kw">size</span>())</a>
<a class="sourceLine" id="cb47-25" data-line-number="25"><span class="co">#&gt; torch.Size([100])</span></a></code></pre></div>
<blockquote>
<p>The <code>predicted</code> and <code>output</code> tensors have the same number of 1D members. It is obvious because <code>predicted</code> is calculated from the <code>output</code> maximum values.</p>
</blockquote>
</div>
<div id="printing-one-output" class="section level3">
<h3><span class="header-section-number">1.6.2</span> Printing one output</h3>
<p>This would be a 1x10 matrix where the largest number is what the model thinks the image is. Here we can see that in the tensor, position 7 has the largest number, indicating the model thinks the image is 7.</p>
<pre><code>number 0: -0.4181
number 1: -1.0784
...
number 7: 2.9352</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb49-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb49-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw">iterate</span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb49-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb49-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb49-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb49-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb49-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb49-10" data-line-number="10">    </a>
<a class="sourceLine" id="cb49-11" data-line-number="11">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb49-12" data-line-number="12">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb49-13" data-line-number="13">    </a>
<a class="sourceLine" id="cb49-14" data-line-number="14">    <span class="cf">if</span> (iter_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb49-15" data-line-number="15">        <span class="kw">print</span>(<span class="st">&#39;OUTPUTS&#39;</span>)</a>
<a class="sourceLine" id="cb49-16" data-line-number="16">        <span class="kw">print</span>(outputs[<span class="dv">1</span>])    <span class="co"># show first tensor of 100</span></a>
<a class="sourceLine" id="cb49-17" data-line-number="17">        <span class="kw">print</span>(outputs[<span class="dv">99</span>])   <span class="co"># show last tensor of 100</span></a>
<a class="sourceLine" id="cb49-18" data-line-number="18">    }</a>
<a class="sourceLine" id="cb49-19" data-line-number="19">    <span class="co"># Get predictions from the maximum value for 100 tensors</span></a>
<a class="sourceLine" id="cb49-20" data-line-number="20">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw">max</span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb49-21" data-line-number="21">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb49-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb49-23" data-line-number="23"><span class="co">#&gt; [1] &quot;OUTPUTS&quot;</span></a>
<a class="sourceLine" id="cb49-24" data-line-number="24"><span class="co">#&gt; Warning in `[.torch.Tensor`(outputs, 1): Incorrect number of dimensions</span></a>
<a class="sourceLine" id="cb49-25" data-line-number="25"><span class="co">#&gt; supplied. The number of supplied arguments, (not counting any NULL,</span></a>
<a class="sourceLine" id="cb49-26" data-line-number="26"><span class="co">#&gt; tf$newaxis or np$newaxis) must match thenumber of dimensions in the tensor,</span></a>
<a class="sourceLine" id="cb49-27" data-line-number="27"><span class="co">#&gt; unless an all_dims() was supplied (this will produce an error in the</span></a>
<a class="sourceLine" id="cb49-28" data-line-number="28"><span class="co">#&gt; future)</span></a>
<a class="sourceLine" id="cb49-29" data-line-number="29"><span class="co">#&gt; tensor([-0.4472, -1.2468, -0.2042, -0.2056,  0.0498, -0.4331, -1.0500,  2.8732,</span></a>
<a class="sourceLine" id="cb49-30" data-line-number="30"><span class="co">#&gt;         -0.1783,  0.8953], grad_fn=&lt;SelectBackward&gt;)</span></a>
<a class="sourceLine" id="cb49-31" data-line-number="31"><span class="co">#&gt; Warning in `[.torch.Tensor`(outputs, 99): Incorrect number of dimensions</span></a>
<a class="sourceLine" id="cb49-32" data-line-number="32"><span class="co">#&gt; supplied. The number of supplied arguments, (not counting any NULL,</span></a>
<a class="sourceLine" id="cb49-33" data-line-number="33"><span class="co">#&gt; tf$newaxis or np$newaxis) must match thenumber of dimensions in the tensor,</span></a>
<a class="sourceLine" id="cb49-34" data-line-number="34"><span class="co">#&gt; unless an all_dims() was supplied (this will produce an error in the</span></a>
<a class="sourceLine" id="cb49-35" data-line-number="35"><span class="co">#&gt; future)</span></a>
<a class="sourceLine" id="cb49-36" data-line-number="36"><span class="co">#&gt; tensor([ 0.7524, -1.2569,  0.6459, -0.9293, -0.3446,  0.4935,  1.8210, -1.1082,</span></a>
<a class="sourceLine" id="cb49-37" data-line-number="37"><span class="co">#&gt;         -0.1197, -0.3373], grad_fn=&lt;SelectBackward&gt;)</span></a>
<a class="sourceLine" id="cb49-38" data-line-number="38"><span class="kw">print</span>(predicted)</a>
<a class="sourceLine" id="cb49-39" data-line-number="39"><span class="co">#&gt; tensor([8, 9, 0, 8, 2, 7, 4, 8, 6, 7, 8, 0, 8, 2, 9, 4, 7, 8, 4, 7, 8, 6, 4, 1,</span></a>
<a class="sourceLine" id="cb49-40" data-line-number="40"><span class="co">#&gt;         4, 2, 2, 4, 4, 7, 0, 1, 9, 2, 8, 7, 8, 2, 6, 0, 0, 6, 3, 8, 8, 9, 1, 4,</span></a>
<a class="sourceLine" id="cb49-41" data-line-number="41"><span class="co">#&gt;         0, 6, 1, 0, 0, 0, 0, 8, 1, 7, 7, 1, 4, 6, 0, 7, 0, 3, 6, 8, 7, 1, 3, 2,</span></a>
<a class="sourceLine" id="cb49-42" data-line-number="42"><span class="co">#&gt;         4, 4, 4, 2, 6, 4, 1, 7, 2, 6, 6, 0, 1, 7, 3, 4, 5, 6, 7, 8, 4, 0, 1, 2,</span></a>
<a class="sourceLine" id="cb49-43" data-line-number="43"><span class="co">#&gt;         3, 4, 1, 6])</span></a></code></pre></div>
</div>
<div id="printing-prediction-output" class="section level3">
<h3><span class="header-section-number">1.6.3</span> Printing prediction output</h3>
<p>Because our output is of size 100 (our batch size), our prediction size would also of the size 100.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb50-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw">iterate</span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb50-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb50-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb50-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb50-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb50-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb50-10" data-line-number="10">    </a>
<a class="sourceLine" id="cb50-11" data-line-number="11">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb50-12" data-line-number="12">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb50-13" data-line-number="13">    </a>
<a class="sourceLine" id="cb50-14" data-line-number="14">    <span class="co"># Get predictions from the maximum value for a batch</span></a>
<a class="sourceLine" id="cb50-15" data-line-number="15">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw">max</span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb50-16" data-line-number="16">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb50-17" data-line-number="17">    </a>
<a class="sourceLine" id="cb50-18" data-line-number="18">    <span class="cf">if</span> (iter_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb50-19" data-line-number="19">        <span class="kw">print</span>(<span class="st">&#39;PREDICTION&#39;</span>)</a>
<a class="sourceLine" id="cb50-20" data-line-number="20">        <span class="kw">print</span>(predicted<span class="op">$</span><span class="kw">size</span>())</a>
<a class="sourceLine" id="cb50-21" data-line-number="21">    }</a>
<a class="sourceLine" id="cb50-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb50-23" data-line-number="23"><span class="co">#&gt; [1] &quot;PREDICTION&quot;</span></a>
<a class="sourceLine" id="cb50-24" data-line-number="24"><span class="co">#&gt; torch.Size([100])</span></a></code></pre></div>
</div>
<div id="print-prediction-value" class="section level3">
<h3><span class="header-section-number">1.6.4</span> Print prediction value</h3>
<p>We are printing our prediction which as verified above, should be digit 7.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb51-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb51-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw">iterate</span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb51-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb51-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb51-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb51-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb51-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb51-10" data-line-number="10">    </a>
<a class="sourceLine" id="cb51-11" data-line-number="11">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb51-12" data-line-number="12">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb51-13" data-line-number="13">    </a>
<a class="sourceLine" id="cb51-14" data-line-number="14">    <span class="co"># Get predictions from the maximum value</span></a>
<a class="sourceLine" id="cb51-15" data-line-number="15">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw">max</span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb51-16" data-line-number="16">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb51-17" data-line-number="17">    </a>
<a class="sourceLine" id="cb51-18" data-line-number="18">    <span class="cf">if</span> (iter_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb51-19" data-line-number="19">        <span class="kw">print</span>(<span class="st">&#39;PREDICTION&#39;</span>)</a>
<a class="sourceLine" id="cb51-20" data-line-number="20">        <span class="kw">print</span>(predicted[1L])</a>
<a class="sourceLine" id="cb51-21" data-line-number="21">    }</a>
<a class="sourceLine" id="cb51-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb51-23" data-line-number="23"><span class="co">#&gt; [1] &quot;PREDICTION&quot;</span></a>
<a class="sourceLine" id="cb51-24" data-line-number="24"><span class="co">#&gt; tensor(7)</span></a></code></pre></div>
</div>
<div id="print-prediction-label-and-label-size" class="section level3">
<h3><span class="header-section-number">1.6.5</span> Print prediction, label and label size</h3>
<p>We are trying to show what we are predicting and the actual values. In this case, weâ€™re predicting the right value 7!</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb52-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb52-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw">iterate</span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb52-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb52-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb52-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb52-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb52-10" data-line-number="10">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb52-11" data-line-number="11">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb52-12" data-line-number="12">    <span class="co"># Get predictions from the maximum value</span></a>
<a class="sourceLine" id="cb52-13" data-line-number="13">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw">max</span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb52-14" data-line-number="14">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb52-15" data-line-number="15">    </a>
<a class="sourceLine" id="cb52-16" data-line-number="16">    <span class="cf">if</span> (iter_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb52-17" data-line-number="17">        <span class="kw">print</span>(<span class="st">&#39;PREDICTION&#39;</span>)</a>
<a class="sourceLine" id="cb52-18" data-line-number="18">        <span class="kw">print</span>(predicted[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb52-19" data-line-number="19">        </a>
<a class="sourceLine" id="cb52-20" data-line-number="20">        <span class="kw">print</span>(<span class="st">&#39;LABEL SIZE&#39;</span>)</a>
<a class="sourceLine" id="cb52-21" data-line-number="21">        <span class="kw">print</span>(labels<span class="op">$</span><span class="kw">size</span>())</a>
<a class="sourceLine" id="cb52-22" data-line-number="22"></a>
<a class="sourceLine" id="cb52-23" data-line-number="23">        <span class="kw">print</span>(<span class="st">&#39;LABEL FOR IMAGE 0&#39;</span>)</a>
<a class="sourceLine" id="cb52-24" data-line-number="24">        <span class="kw">print</span>(labels[<span class="dv">1</span>]<span class="op">$</span><span class="kw">item</span>())  <span class="co"># extract the scalar part only</span></a>
<a class="sourceLine" id="cb52-25" data-line-number="25">    }</a>
<a class="sourceLine" id="cb52-26" data-line-number="26">}</a>
<a class="sourceLine" id="cb52-27" data-line-number="27"><span class="co">#&gt; [1] &quot;PREDICTION&quot;</span></a>
<a class="sourceLine" id="cb52-28" data-line-number="28"><span class="co">#&gt; tensor(7)</span></a>
<a class="sourceLine" id="cb52-29" data-line-number="29"><span class="co">#&gt; [1] &quot;LABEL SIZE&quot;</span></a>
<a class="sourceLine" id="cb52-30" data-line-number="30"><span class="co">#&gt; torch.Size([100])</span></a>
<a class="sourceLine" id="cb52-31" data-line-number="31"><span class="co">#&gt; [1] &quot;LABEL FOR IMAGE 0&quot;</span></a>
<a class="sourceLine" id="cb52-32" data-line-number="32"><span class="co">#&gt; [1] 7</span></a></code></pre></div>
</div>
<div id="print-second-prediction-and-ground-truth" class="section level3">
<h3><span class="header-section-number">1.6.6</span> Print second prediction and ground truth</h3>
<p>It should be the digit 2.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb53-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb53-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw">iterate</span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb53-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb53-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb53-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb53-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb53-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb53-10" data-line-number="10">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb53-11" data-line-number="11">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb53-12" data-line-number="12">    <span class="co"># Get predictions from the maximum value</span></a>
<a class="sourceLine" id="cb53-13" data-line-number="13">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw">max</span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb53-14" data-line-number="14">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb53-15" data-line-number="15">    </a>
<a class="sourceLine" id="cb53-16" data-line-number="16">    <span class="cf">if</span> (iter_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb53-17" data-line-number="17">        <span class="kw">print</span>(<span class="st">&#39;PREDICTION&#39;</span>)</a>
<a class="sourceLine" id="cb53-18" data-line-number="18">        <span class="kw">print</span>(predicted[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb53-19" data-line-number="19">        </a>
<a class="sourceLine" id="cb53-20" data-line-number="20">        <span class="kw">print</span>(<span class="st">&#39;LABEL SIZE&#39;</span>)</a>
<a class="sourceLine" id="cb53-21" data-line-number="21">        <span class="kw">print</span>(labels<span class="op">$</span><span class="kw">size</span>())</a>
<a class="sourceLine" id="cb53-22" data-line-number="22"></a>
<a class="sourceLine" id="cb53-23" data-line-number="23">        <span class="kw">print</span>(<span class="st">&#39;LABEL FOR IMAGE 0&#39;</span>)</a>
<a class="sourceLine" id="cb53-24" data-line-number="24">        <span class="kw">print</span>(labels[<span class="dv">1</span>]<span class="op">$</span><span class="kw">item</span>())</a>
<a class="sourceLine" id="cb53-25" data-line-number="25">    }</a>
<a class="sourceLine" id="cb53-26" data-line-number="26">}</a>
<a class="sourceLine" id="cb53-27" data-line-number="27"><span class="co">#&gt; [1] &quot;PREDICTION&quot;</span></a>
<a class="sourceLine" id="cb53-28" data-line-number="28"><span class="co">#&gt; tensor(7)</span></a>
<a class="sourceLine" id="cb53-29" data-line-number="29"><span class="co">#&gt; [1] &quot;LABEL SIZE&quot;</span></a>
<a class="sourceLine" id="cb53-30" data-line-number="30"><span class="co">#&gt; torch.Size([100])</span></a>
<a class="sourceLine" id="cb53-31" data-line-number="31"><span class="co">#&gt; [1] &quot;LABEL FOR IMAGE 0&quot;</span></a>
<a class="sourceLine" id="cb53-32" data-line-number="32"><span class="co">#&gt; [1] 7</span></a></code></pre></div>
</div>
<div id="print-accuracy" class="section level3">
<h3><span class="header-section-number">1.6.7</span> Print accuracy</h3>
<p>Now we know what each object represents, we can understand how we arrived at our accuracy numbers.</p>
<p>One last thing to note is that <code>correct.item()</code> has this syntax is because correct is a PyTorch tensor and to get the value to compute with total which is an integer, we need to do this.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb54-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb54-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb54-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw">iterate</span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb54-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb54-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb54-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb54-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb54-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb54-10" data-line-number="10">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb54-11" data-line-number="11">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb54-12" data-line-number="12">    <span class="co"># Get predictions from the maximum value</span></a>
<a class="sourceLine" id="cb54-13" data-line-number="13">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw">max</span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb54-14" data-line-number="14">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb54-15" data-line-number="15">    <span class="co"># Total number of labels</span></a>
<a class="sourceLine" id="cb54-16" data-line-number="16">    total =<span class="st"> </span>total <span class="op">+</span><span class="st"> </span>labels<span class="op">$</span><span class="kw">size</span>(0L)</a>
<a class="sourceLine" id="cb54-17" data-line-number="17">    <span class="co"># Total correct predictions</span></a>
<a class="sourceLine" id="cb54-18" data-line-number="18">    correct =<span class="st"> </span>correct <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>((predicted<span class="op">$</span><span class="kw">numpy</span>() <span class="op">==</span><span class="st"> </span>labels<span class="op">$</span><span class="kw">numpy</span>()))</a>
<a class="sourceLine" id="cb54-19" data-line-number="19">}</a>
<a class="sourceLine" id="cb54-20" data-line-number="20">accuracy =<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>correct <span class="op">/</span><span class="st"> </span>total</a>
<a class="sourceLine" id="cb54-21" data-line-number="21"><span class="kw">print</span>(accuracy)</a>
<a class="sourceLine" id="cb54-22" data-line-number="22"><span class="co">#&gt; [1] 83.3</span></a></code></pre></div>
</div>
</div>
<div id="saving-pytorch-model" class="section level2">
<h2><span class="header-section-number">1.7</span> Saving PyTorch model</h2>
<p>This is how you save your model.
Feel free to just change <code>save_model = TRUE</code> to save your model</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">save_model =<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="cf">if</span> (save_model) {</a>
<a class="sourceLine" id="cb55-3" data-line-number="3">    <span class="co"># Saves only parameters</span></a>
<a class="sourceLine" id="cb55-4" data-line-number="4">    torch<span class="op">$</span><span class="kw">save</span>(model<span class="op">$</span><span class="kw">state_dict</span>(), <span class="st">&#39;awesome_model.pkl&#39;</span>)</a>
<a class="sourceLine" id="cb55-5" data-line-number="5">}</a></code></pre></div>

</div>
</div>



</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="working-with-data-frame.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["one_at_a_time.pdf", "one_at_a_time.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
